"use strict";(self.webpackChunkdemo1=self.webpackChunkdemo1||[]).push([[901],{6901:(ve,F,l)=>{l.r(F),l.d(F,{ProductsModule:()=>be});var d=l(177),_=l(2791),t=l(7705);let w=(()=>{class o{static \u0275fac=function(n){return new(n||o)};static \u0275cmp=t.VBU({type:o,selectors:[["app-products"]],decls:1,vars:0,template:function(n,i){1&n&&t.nrm(0,"router-outlet")},dependencies:[_.n3]})}return o})();var b=l(499),f=l(5794),c=l(9417),h=l(7482);function y(o,s){1&o&&(t.j41(0,"div",6)(1,"div",83)(2,"span",84),t.EFF(3,"Cargando..."),t.k0s()()())}function M(o,s){if(1&o&&(t.qex(0),t.j41(1,"option",85),t.EFF(2),t.k0s(),t.bVm()),2&o){const e=s.$implicit;t.R7$(1),t.Y8G("value",e.id),t.R7$(1),t.JRh(e.name)}}function S(o,s){1&o&&(t.j41(0,"div",86)(1,"div",87),t.nrm(2,"i",88),t.j41(3,"div",89),t.EFF(4,"Vista previa"),t.k0s()()())}function I(o,s){if(1&o){const e=t.RV6();t.j41(0,"div")(1,"ng-multiselect-dropdown",90),t.bIt("ngModelChange",function(i){t.eBV(e);const a=t.XpG();return t.Njj(a.selectedItems=i)})("onSelect",function(i){t.eBV(e);const a=t.XpG();return t.Njj(a.onItemSelect(i))})("onSelectAll",function(i){t.eBV(e);const a=t.XpG();return t.Njj(a.onSelectAll(i))}),t.k0s()()}if(2&o){const e=t.XpG();t.R7$(1),t.Y8G("placeholder","Etiquetas disponibles")("settings",e.dropdownSettings)("data",e.dropdownList)("ngModel",e.selectedItems)}}function T(o,s){1&o&&(t.j41(0,"span"),t.EFF(1,"Publicar Anuncio"),t.k0s())}function P(o,s){1&o&&(t.j41(0,"span"),t.EFF(1,"Publicando..."),t.k0s())}let V=(()=>{class o{productService;toastr;router;title="";sku="";price_pen=0;description="";imagen_previsualiza="https://preview.keenthemes.com/metronic8/demo1/assets/media/svg/illustrations/easy/2.svg";file_imagen=null;location="";contact_phone="";contact_email="";expires_at="";categorie_first_id="";categories_first=[];dropdownList=[];selectedItems=[];dropdownSettings={};word="";isShowMultiselect=!1;isLoading$;allowedImageTypes=["image/jpeg","image/jpg","image/png","image/gif","image/bmp","image/webp"];constructor(e,n,i){this.productService=e,this.toastr=n,this.router=i}ngOnInit(){this.isLoading$=this.productService.isLoading$,this.dropdownSettings={singleSelection:!1,idField:"item_id",textField:"item_text",selectAllText:"Seleccionar Todo",unSelectAllText:"Deseleccionar Todo",allowSearchFilter:!0};const e=new Date;e.setDate(e.getDate()+15),this.expires_at=e.toISOString().split("T")[0],this.configAll()}generateSku(){if(this.title&&""!==this.title.trim()){let e=this.title.toUpperCase().replace(/[^A-Z0-9\s]/g,"").replace(/\s+/g,"").substring(0,6);const n=Math.floor(Math.random()+1e3)+1;this.sku=e+n.toString().padStart(4,"0")}}onTitleChange(){this.generateSku(),this.generateKeywords()}generateKeywords(){let e="";if(this.title&&(e+=this.title+" "),this.description&&(e+=this.description+" "),this.location&&(e+=this.location+" "),""===e.trim())return;let n=e.toLowerCase().replace(/[^\w\s\xe1\xe9\xed\xf3\xfa\xf1\xfc]/g," ").replace(/\s+/g," ").trim().split(" ").filter(a=>a.length>3).filter(a=>!this.isStopWord(a)),i=[...new Set(n)].slice(0,10);this.selectedItems=this.selectedItems.filter(a=>!a.auto_generated),this.dropdownList=this.dropdownList.filter(a=>!a.auto_generated),i.forEach(a=>{let E={item_id:(new Date).getTime()+Math.random(),item_text:a,auto_generated:!0};this.dropdownList.push(E),this.selectedItems.push(E)})}isStopWord(e){return["para","con","por","como","una","este","esta","estos","estas","del","las","los","una","uno","sobre","entre","hasta","desde","que","son","m\xe1s","pero","muy","bien","toda","todo","hace","the","and","for","are","but","not","you","all","can","had","her","was","one","our","out","day","get","has","him","his"].includes(e.toLowerCase())}onDescriptionChange(){this.generateKeywords()}onLocationChange(){this.generateKeywords()}configAll(){this.productService.configAll().subscribe({next:e=>{console.log("Configuraci\xf3n crear anuncios cargada:",e),this.categories_first=e.categories||[]},error:e=>{console.error("Error al cargar configuraci\xf3n en crear anuncio:",e),this.toastr.error("Error","No se pudo cargar la configuraci\xf3n necesaria")}})}addItems(){if(console.log("Intentando agregar tag:",this.word),!this.word||""===this.word.trim())return void this.toastr.error("Validaci\xf3n","Debe ingresar una etiqueta");this.isShowMultiselect=!0;let e=(new Date).getTime();this.dropdownList.push({item_id:e,item_text:this.word}),this.selectedItems.push({item_id:e,item_text:this.word}),console.log("Tag agregada correctamente:",this.word),setTimeout(()=>{this.word="",this.isShowMultiselect=!1,this.isLoadingView()},100)}processFile(e){if(!e.target.files||!e.target.files[0])return void this.toastr.error("Validaci\xf3n","No se seleccion\xf3 ninguna imagen");const n=e.target.files[0];if(!this.allowedImageTypes.includes(n.type.toLowerCase()))return this.toastr.error("Validaci\xf3n",`Tipo de archivo no v\xe1lido. Solo se permiten: ${this.allowedImageTypes.join(", ").replace(/image\//g,"").toUpperCase()}`),void(e.target.value="");if(n.size>5242880)return this.toastr.error("Validaci\xf3n","El archivo es demasiado grande. Tama\xf1o m\xe1ximo: 5MB"),void(e.target.value="");this.file_imagen=n,console.log("Archivo de imagen seleccionado:",{name:n.name,type:n.type,size:n.size});let a=new FileReader;a.readAsDataURL(this.file_imagen),a.onloadend=()=>this.imagen_previsualiza=a.result,this.isLoadingView()}isLoadingView(){this.productService.isLoadingSubject.next(!0),setTimeout(()=>{this.productService.isLoadingSubject.next(!1)},50)}onChange(e){this.description=e.editor.getData()}onItemSelect(e){console.log(e)}onSelectAll(e){console.log(e)}validateEmail(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}validatePhone(e){return/^[+]?[0-9\s\-\(\)]{7,15}$/.test(e)}save(){if(console.log("Verificando campos del formulario..."),!(this.title&&this.file_imagen&&this.categorie_first_id&&this.description))return void this.toastr.error("Validaci\xf3n","Los campos con * son obligatorios: T\xedtulo, Imagen, Categor\xeda y Descripci\xf3n");if(this.contact_email&&!this.validateEmail(this.contact_email))return void this.toastr.error("Validaci\xf3n","El formato del email de contacto no es v\xe1lido");if(this.contact_phone&&!this.validatePhone(this.contact_phone))return void this.toastr.error("Validaci\xf3n","El formato del tel\xe9fono no es v\xe1lido (7-15 d\xedgitos)");if(this.price_pen&&this.price_pen<=0)return void this.toastr.error("Validaci\xf3n","El precio debe ser mayor a 0");console.log("Todos los campos son v\xe1lidos. Preparando FormData...");let e=new FormData;e.append("title",this.title),e.append("sku",this.sku),e.append("portada",this.file_imagen),e.append("categorie_first_id",this.categorie_first_id),e.append("description",this.description),this.price_pen&&this.price_pen>0&&e.append("price_pen",this.price_pen.toString()),this.location&&e.append("location",this.location),this.contact_phone&&e.append("contact_phone",this.contact_phone),this.contact_email&&e.append("contact_email",this.contact_email),e.append("expires_at",this.expires_at),this.selectedItems.length>0&&e.append("tags",JSON.stringify(this.selectedItems)),console.log("FormData preparado. Enviando solicitud para crear anuncio..."),console.log("Contenido del FormData:"),console.log("- title:",this.title),console.log("- sku:",this.sku),console.log("- portada (archivo):",this.file_imagen?this.file_imagen.name+" ("+this.file_imagen.size+" bytes)":"ninguno"),console.log("- categorie_first_id:",this.categorie_first_id),console.log("- description:",this.description?this.description.substring(0,50)+"...":"vac\xedo"),this.productService.createProducts(e).subscribe({next:n=>{console.log("Respuesta del servidor:",n),403==n.message?this.toastr.error("Error de permisos",n.message_text):500==n.message?this.toastr.error("Error del servidor",n.message_text):400==n.message?this.toastr.error("Error de validaci\xf3n",n.message_text):(this.resetForm(),this.toastr.success("\xc9xito","El anuncio se registr\xf3 correctamente"),console.log("Anuncio creado exitosamente"),this.notifyDashboardUpdate(),setTimeout(()=>{this.router.navigate(["/products/list"])},1e3))},error:n=>{console.error("Error al crear anuncio:",n),403===n.status?this.toastr.error("Error de permisos","No tienes permiso para crear anuncios"):this.toastr.error("Error",n.error&&n.error.message_text?n.error.message_text:"Ha ocurrido un error al crear el anuncio")}})}resetForm(){this.title="",this.sku="",this.price_pen=0,this.description="",this.location="",this.contact_phone="",this.contact_email="",this.file_imagen=null,this.categorie_first_id="",this.selectedItems=[],this.dropdownList=[];const e=new Date;e.setDate(e.getDate()+15),this.expires_at=e.toISOString().split("T")[0],this.imagen_previsualiza="https://preview.keenthemes.com/metronic8/demo1/assets/media/svg/illustrations/easy/2.svg"}notifyDashboardUpdate(){localStorage.setItem("dashboard_needs_update","true"),window.dispatchEvent(new CustomEvent("anuncio-created"))}static \u0275fac=function(n){return new(n||o)(t.rXU(b.b),t.rXU(f.tw),t.rXU(_.Ix))};static \u0275cmp=t.VBU({type:o,selectors:[["app-create-product"]],decls:204,vars:25,consts:[[1,"container-fluid","py-4"],[1,"row","justify-content-center"],[1,"col-12","col-xl-10"],[1,"card","border-0","shadow-sm","mb-4"],[1,"card-header","bg-gradient-primary","border-0","py-4"],[1,"d-flex","align-items-center"],[1,"flex-shrink-0"],[1,"symbol","symbol-50px"],[1,"symbol-label","bg-white","bg-opacity-20"],[1,"fas","fa-plus-circle","text-white","fs-2x"],[1,"flex-grow-1","ms-4"],[1,"text-white","mb-1","fs-2","fw-bold"],[1,"text-white-50","mb-0","fs-6"],["class","flex-shrink-0",4,"ngIf"],["novalidate","",1,"needs-validation"],[1,"card-header","bg-light","py-3"],[1,"badge","badge-circle","badge-primary","me-3","fs-6"],[1,"mb-0","text-gray-800"],[1,"text-muted"],[1,"card-body","p-6"],[1,"row","g-4"],[1,"col-12","col-lg-8"],[1,"form-floating"],["type","text","id","title","name","title","placeholder","T\xedtulo de tu anuncio","required","",1,"form-control",3,"ngModel","ngModelChange"],["for","title"],[1,"text-danger"],[1,"form-text","text-muted"],[1,"fas","fa-lightbulb","text-warning","me-1"],[1,"col-12","col-lg-4"],["type","text","id","sku","name","sku","placeholder","SKU","readonly","",1,"form-control","bg-light",3,"ngModel","ngModelChange"],["for","sku"],[1,"fas","fa-magic","text-primary","me-1"],[1,"col-12"],["id","categoria","name","categoria","required","",1,"form-select",3,"ngModel","ngModelChange"],["value",""],[4,"ngFor","ngForOf"],["for","categoria"],[1,"fas","fa-tag","text-success","me-1"],[1,"badge","badge-circle","badge-success","me-3","fs-6"],[1,"col-12","col-md-6"],[1,"input-group"],[1,"input-group-text","bg-light-success","border-success"],[1,"fas","fa-dollar-sign","text-success"],[1,"form-floating","flex-grow-1"],["type","number","id","price","name","price_pen","placeholder","0.00","min","0","step","0.01",1,"form-control","border-success",3,"ngModel","ngModelChange"],["for","price"],["type","text","id","location","name","location","placeholder","Tingo Mar\xeda",1,"form-control",3,"ngModel","ngModelChange"],["for","location"],[1,"badge","badge-circle","badge-info","me-3","fs-6"],["type","tel","id","phone","name","contact_phone","placeholder","Tel\xe9fono",1,"form-control",3,"ngModel","ngModelChange"],["for","phone"],["type","email","id","email","name","contact_email","placeholder","Email",1,"form-control",3,"ngModel","ngModelChange"],["for","email"],[1,"badge","badge-circle","badge-warning","me-3","fs-6"],[1,"row","g-4","align-items-center"],[1,"border","border-dashed","border-primary","rounded","p-4","text-center"],["type","file","id","image-upload","accept","image/jpeg,image/jpg,image/png,image/gif,image/bmp,image/webp",1,"form-control","d-none",3,"change"],["for","image-upload",1,"btn","btn-light-primary","btn-lg","mb-3","cursor-pointer"],[1,"fas","fa-cloud-upload-alt","me-2"],[1,"text-center"],[1,"position-relative","d-inline-block"],["alt","Vista previa",1,"img-fluid","rounded","shadow-sm","border",2,"max-width","100%","max-height","200px","object-fit","cover",3,"src"],["class","position-absolute top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center bg-dark bg-opacity-50 rounded",4,"ngIf"],[1,"badge","badge-circle","badge-secondary","me-3","fs-6"],["id","description","name","description","placeholder","Descripci\xf3n","required","",1,"form-control",2,"min-height","150px",3,"ngModel","ngModelChange"],["for","description"],[1,"d-flex","align-items-start"],[1,"fas","fa-info-circle","text-primary","me-2","mt-1"],[1,"d-flex","align-items-center","justify-content-between"],[1,"badge","badge-circle","badge-light","me-3","fs-6"],["type","button",1,"btn","btn-sm","btn-light-primary",3,"click"],[1,"fas","fa-magic","me-1"],[1,"input-group","mb-3"],["type","text","name","word","placeholder","Agregar etiqueta personalizada",1,"form-control",3,"ngModel","ngModelChange"],["type","button",1,"btn","btn-outline-primary",3,"click"],[1,"fas","fa-plus"],[4,"ngIf"],[1,"mt-4"],[1,"d-flex","flex-column","flex-md-row","gap-3","justify-content-end"],["type","button","onclick","history.back()",1,"btn","btn-light-secondary","btn-lg","flex-fill","flex-md-grow-0"],[1,"fas","fa-arrow-left","me-2"],["type","button",1,"btn","btn-primary","btn-lg","flex-fill","flex-md-grow-0",3,"disabled","click"],[1,"fas","fa-paper-plane","me-2"],["role","status",1,"spinner-border","text-white"],[1,"visually-hidden"],[3,"value"],[1,"position-absolute","top-0","start-0","w-100","h-100","d-flex","align-items-center","justify-content-center","bg-dark","bg-opacity-50","rounded"],[1,"text-white","text-center"],[1,"fas","fa-image","fs-2x","mb-2"],[1,"fs-6"],[1,"dropdown-up",3,"placeholder","settings","data","ngModel","ngModelChange","onSelect","onSelectAll"]],template:function(n,i){1&n&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8),t.nrm(9,"i",9),t.k0s()()(),t.j41(10,"div",10)(11,"h1",11),t.EFF(12,"Crear Nuevo Anuncio"),t.k0s(),t.j41(13,"p",12),t.EFF(14,"Publica tu producto o servicio en AvisOnline de forma r\xe1pida y sencilla"),t.k0s()(),t.DNE(15,y,4,0,"div",13),t.nI1(16,"async"),t.k0s()()(),t.j41(17,"form",14)(18,"div",3)(19,"div",15)(20,"div",5)(21,"span",16),t.EFF(22,"1"),t.k0s(),t.j41(23,"div")(24,"h5",17),t.EFF(25,"Informaci\xf3n B\xe1sica"),t.k0s(),t.j41(26,"small",18),t.EFF(27,"T\xedtulo y categor\xeda de tu anuncio"),t.k0s()()()(),t.j41(28,"div",19)(29,"div",20)(30,"div",21)(31,"div",22)(32,"input",23),t.bIt("ngModelChange",function(r){return i.title=r})("ngModelChange",function(){return i.onTitleChange()}),t.k0s(),t.j41(33,"label",24),t.EFF(34,"T\xedtulo del anuncio "),t.j41(35,"span",25),t.EFF(36,"*"),t.k0s()()(),t.j41(37,"div",26),t.nrm(38,"i",27),t.EFF(39,' S\xe9 espec\xedfico y atractivo (ej: "iPhone 12 Pro Max 256GB como nuevo") '),t.k0s()(),t.j41(40,"div",28)(41,"div",22)(42,"input",29),t.bIt("ngModelChange",function(r){return i.sku=r}),t.k0s(),t.j41(43,"label",30),t.EFF(44,"C\xf3digo SKU (autom\xe1tico)"),t.k0s()(),t.j41(45,"div",26),t.nrm(46,"i",31),t.EFF(47," Se genera autom\xe1ticamente "),t.k0s()(),t.j41(48,"div",32)(49,"div",22)(50,"select",33),t.bIt("ngModelChange",function(r){return i.categorie_first_id=r}),t.j41(51,"option",34),t.EFF(52,"Selecciona una categor\xeda"),t.k0s(),t.DNE(53,M,3,2,"ng-container",35),t.k0s(),t.j41(54,"label",36),t.EFF(55,"Categor\xeda "),t.j41(56,"span",25),t.EFF(57,"*"),t.k0s()()(),t.j41(58,"div",26),t.nrm(59,"i",37),t.EFF(60," Elige la categor\xeda que mejor describa tu producto "),t.k0s()()()()(),t.j41(61,"div",3)(62,"div",15)(63,"div",5)(64,"span",38),t.EFF(65,"2"),t.k0s(),t.j41(66,"div")(67,"h5",17),t.EFF(68,"Precio y Ubicaci\xf3n"),t.k0s(),t.j41(69,"small",18),t.EFF(70,"Informaci\xf3n comercial (opcional)"),t.k0s()()()(),t.j41(71,"div",19)(72,"div",20)(73,"div",39)(74,"div",40)(75,"span",41),t.nrm(76,"i",42),t.k0s(),t.j41(77,"div",43)(78,"input",44),t.bIt("ngModelChange",function(r){return i.price_pen=r}),t.k0s(),t.j41(79,"label",45),t.EFF(80,"Precio en Soles (PEN)"),t.k0s()()(),t.j41(81,"div",26),t.EFF(82,' Deja vac\xedo si prefieres "Precio a consultar" '),t.k0s()(),t.j41(83,"div",39)(84,"div",22)(85,"input",46),t.bIt("ngModelChange",function(r){return i.location=r})("ngModelChange",function(){return i.onLocationChange()}),t.k0s(),t.j41(86,"label",47),t.EFF(87,"Ubicaci\xf3n"),t.k0s()(),t.j41(88,"div",26),t.EFF(89," Ciudad, distrito (ej: Tingo Mar\xeda, Rupa Rupa) "),t.k0s()()()()(),t.j41(90,"div",3)(91,"div",15)(92,"div",5)(93,"span",48),t.EFF(94,"3"),t.k0s(),t.j41(95,"div")(96,"h5",17),t.EFF(97,"Informaci\xf3n de Contacto"),t.k0s(),t.j41(98,"small",18),t.EFF(99,"Datos para que te contacten (opcional)"),t.k0s()()()(),t.j41(100,"div",19)(101,"div",20)(102,"div",39)(103,"div",22)(104,"input",49),t.bIt("ngModelChange",function(r){return i.contact_phone=r}),t.k0s(),t.j41(105,"label",50),t.EFF(106,"Tel\xe9fono"),t.k0s()(),t.j41(107,"div",26),t.EFF(108," Incluye c\xf3digo de pa\xeds (+51 999 888 777) "),t.k0s()(),t.j41(109,"div",39)(110,"div",22)(111,"input",51),t.bIt("ngModelChange",function(r){return i.contact_email=r}),t.k0s(),t.j41(112,"label",52),t.EFF(113,"Email de contacto"),t.k0s()(),t.j41(114,"div",26),t.EFF(115," Email alternativo para contacto directo "),t.k0s()()()()(),t.j41(116,"div",3)(117,"div",15)(118,"div",5)(119,"span",53),t.EFF(120,"4"),t.k0s(),t.j41(121,"div")(122,"h5",17),t.EFF(123,"Imagen Principal"),t.k0s(),t.j41(124,"small",18),t.EFF(125,"Sube la foto principal de tu anuncio"),t.k0s()()()(),t.j41(126,"div",19)(127,"div",54)(128,"div",39)(129,"div",55)(130,"input",56),t.bIt("change",function(r){return i.processFile(r)}),t.k0s(),t.j41(131,"label",57),t.nrm(132,"i",58),t.EFF(133," Seleccionar Imagen "),t.k0s(),t.j41(134,"div",18)(135,"small")(136,"strong"),t.EFF(137,"Formatos:"),t.k0s(),t.EFF(138," JPG, PNG, GIF, WEBP"),t.nrm(139,"br"),t.j41(140,"strong"),t.EFF(141,"Tama\xf1o m\xe1ximo:"),t.k0s(),t.EFF(142," 5MB "),t.k0s()()()(),t.j41(143,"div",39)(144,"div",59)(145,"div",60),t.nrm(146,"img",61),t.DNE(147,S,5,0,"div",62),t.k0s()()()()()(),t.j41(148,"div",3)(149,"div",15)(150,"div",5)(151,"span",63),t.EFF(152,"5"),t.k0s(),t.j41(153,"div")(154,"h5",17),t.EFF(155,"Descripci\xf3n Detallada"),t.k0s(),t.j41(156,"small",18),t.EFF(157,"Describe tu producto de manera completa y atractiva"),t.k0s()()()(),t.j41(158,"div",19)(159,"div",22)(160,"textarea",64),t.bIt("ngModelChange",function(r){return i.description=r})("ngModelChange",function(){return i.onDescriptionChange()}),t.k0s(),t.j41(161,"label",65),t.EFF(162,"Descripci\xf3n del anuncio "),t.j41(163,"span",25),t.EFF(164,"*"),t.k0s()()(),t.j41(165,"div",26)(166,"div",66),t.nrm(167,"i",67),t.j41(168,"div")(169,"strong"),t.EFF(170,"Incluye:"),t.k0s(),t.EFF(171," Estado del producto, caracter\xedsticas principales, motivo de venta, condiciones de entrega. "),t.k0s()()()()(),t.j41(172,"div",3)(173,"div",15)(174,"div",68)(175,"div",5)(176,"span",69),t.EFF(177,"6"),t.k0s(),t.j41(178,"div")(179,"h5",17),t.EFF(180,"Etiquetas"),t.k0s(),t.j41(181,"small",18),t.EFF(182,"Palabras clave para mejorar b\xfasquedas (opcional)"),t.k0s()()(),t.j41(183,"button",70),t.bIt("click",function(){return i.generateKeywords()}),t.nrm(184,"i",71),t.EFF(185," Auto-generar "),t.k0s()()(),t.j41(186,"div",19)(187,"div",72)(188,"input",73),t.bIt("ngModelChange",function(r){return i.word=r}),t.k0s(),t.j41(189,"button",74),t.bIt("click",function(){return i.addItems()}),t.nrm(190,"i",75),t.k0s()(),t.DNE(191,I,2,4,"div",76),t.k0s()()(),t.j41(192,"div",77)(193,"div",78)(194,"button",79),t.nrm(195,"i",80),t.EFF(196," Cancelar "),t.k0s(),t.j41(197,"button",81),t.bIt("click",function(){return i.save()}),t.nI1(198,"async"),t.nrm(199,"i",82),t.DNE(200,T,2,0,"span",76),t.nI1(201,"async"),t.DNE(202,P,2,0,"span",76),t.nI1(203,"async"),t.k0s()()()()()()),2&n&&(t.R7$(15),t.Y8G("ngIf",t.bMT(16,17,i.isLoading$)),t.R7$(17),t.Y8G("ngModel",i.title),t.R7$(10),t.Y8G("ngModel",i.sku),t.R7$(8),t.Y8G("ngModel",i.categorie_first_id),t.R7$(3),t.Y8G("ngForOf",i.categories_first),t.R7$(25),t.Y8G("ngModel",i.price_pen),t.R7$(7),t.Y8G("ngModel",i.location),t.R7$(19),t.Y8G("ngModel",i.contact_phone),t.R7$(7),t.Y8G("ngModel",i.contact_email),t.R7$(35),t.Y8G("src",i.imagen_previsualiza,t.B4B),t.R7$(1),t.Y8G("ngIf",!i.imagen_previsualiza||"/assets/media/svg/files/blank-image.svg"===i.imagen_previsualiza),t.R7$(13),t.Y8G("ngModel",i.description),t.R7$(28),t.Y8G("ngModel",i.word),t.R7$(3),t.Y8G("ngIf",!i.isShowMultiselect&&i.selectedItems.length>0),t.R7$(6),t.Y8G("disabled",t.bMT(198,19,i.isLoading$)),t.R7$(3),t.Y8G("ngIf",!t.bMT(201,21,i.isLoading$)),t.R7$(2),t.Y8G("ngIf",t.bMT(203,23,i.isLoading$)))},dependencies:[d.Sq,d.bT,c.qT,c.xH,c.y7,c.me,c.Q0,c.wz,c.BC,c.cb,c.YS,c.VZ,c.vS,c.cV,h.b,d.Jj],styles:['@charset "UTF-8";.bg-gradient-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#007bff 0%,#0056b3 100%)}.badge-circle[_ngcontent-%COMP%]{width:2.5rem;height:2.5rem;display:flex;align-items:center;justify-content:center;border-radius:50%;font-weight:600}.form-floating[_ngcontent-%COMP%]{position:relative}.form-floating[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%]:focus, .form-floating[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%]:not(:placeholder-shown){padding-top:1.625rem;padding-bottom:.625rem}.form-floating[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;padding:1rem .75rem;overflow:hidden;text-align:start;text-overflow:ellipsis;white-space:nowrap;pointer-events:none;border:1px solid transparent;transform-origin:0 0;transition:opacity .1s ease-in-out,transform .1s ease-in-out;color:#6c757d}.form-floating[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%]:focus ~ label[_ngcontent-%COMP%], .form-floating[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%]:not(:placeholder-shown) ~ label[_ngcontent-%COMP%]{opacity:.65;transform:scale(.85) translateY(-.5rem) translate(.15rem);color:#007bff}.form-floating[_ngcontent-%COMP%] > .form-select[_ngcontent-%COMP%]:focus ~ label[_ngcontent-%COMP%], .form-floating[_ngcontent-%COMP%] > .form-select[_ngcontent-%COMP%]:not([value=""]) ~ label[_ngcontent-%COMP%]{opacity:.65;transform:scale(.85) translateY(-.5rem) translate(.15rem);color:#007bff}.card[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 .5rem 1rem #0000001a!important}.form-control[_ngcontent-%COMP%]:focus{border-color:#007bff;box-shadow:0 0 0 .2rem #007bff40}.form-select[_ngcontent-%COMP%]:focus{border-color:#007bff;box-shadow:0 0 0 .2rem #007bff40}.btn-light-primary[_ngcontent-%COMP%]:hover{background-color:#007bff;border-color:#007bff;color:#fff}.cursor-pointer[_ngcontent-%COMP%]{cursor:pointer}.border-dashed[_ngcontent-%COMP%]{border-style:dashed!important}@media (max-width: 768px){.card-header[_ngcontent-%COMP%], .card-body[_ngcontent-%COMP%]{padding:1rem!important}.badge-circle[_ngcontent-%COMP%]{width:2rem;height:2rem;font-size:.875rem}}.form-control[_ngcontent-%COMP%], .form-select[_ngcontent-%COMP%], .btn[_ngcontent-%COMP%]{transition:all .15s ease-in-out}.image-upload-area[_ngcontent-%COMP%]{transition:all .3s ease}.image-upload-area[_ngcontent-%COMP%]:hover{background-color:#007bff0d;border-color:#007bff!important}.badge-circle.badge-primary[_ngcontent-%COMP%]{background-color:#007bff;color:#fff}.badge-circle.badge-success[_ngcontent-%COMP%]{background-color:#28a745;color:#fff}.badge-circle.badge-info[_ngcontent-%COMP%]{background-color:#17a2b8;color:#fff}.badge-circle.badge-warning[_ngcontent-%COMP%]{background-color:#ffc107;color:#212529}.badge-circle.badge-secondary[_ngcontent-%COMP%]{background-color:#6c757d;color:#fff}.badge-circle.badge-light[_ngcontent-%COMP%]{background-color:#f8f9fa;color:#6c757d;border:2px solid #dee2e6}.dropdown-container[_ngcontent-%COMP%]{min-height:60px!important;position:relative!important;margin-bottom:1rem!important}.dropdown-wrapper[_ngcontent-%COMP%]{position:relative!important;z-index:1000!important}[_nghost-%COMP%]     .ng-multiselect-dropdown{position:relative!important}[_nghost-%COMP%]     .ng-multiselect-dropdown .dropdown-list{z-index:10000!important;position:absolute!important;inset:auto 0 100%!important;max-height:200px!important;overflow-y:auto!important;background:white!important;border:1px solid #dee2e6!important;border-radius:.375rem!important;box-shadow:0 -.5rem 1rem #00000026!important;margin-bottom:.5rem!important;transform:translateY(-2px)!important}[_nghost-%COMP%]     .ng-multiselect-dropdown .dropdown-btn{border:1px solid #ced4da!important;border-radius:.375rem!important;padding:.75rem!important;background:white!important;width:100%!important;min-height:48px!important}[_nghost-%COMP%]     .ng-multiselect-dropdown .dropdown-btn:focus{border-color:#007bff!important;box-shadow:0 0 0 .2rem #007bff40!important}[_nghost-%COMP%]     .ng-multiselect-dropdown .dropdown-btn:hover{border-color:#007bff!important}.container-fluid[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f8f9fa 0%,#e9ecef 100%);padding:2rem 0;margin-top:3rem!important}.container-fluid[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{border:none!important;box-shadow:0 .5rem 1.5rem #0000001a!important}.dropdown-container[_ngcontent-%COMP%]{margin-bottom:2rem!important}.btn[_ngcontent-%COMP%]{white-space:nowrap!important}.btn[_ngcontent-%COMP%]   .fas[_ngcontent-%COMP%], .btn[_ngcontent-%COMP%]   .fa[_ngcontent-%COMP%]{margin-right:.5rem!important}.btn-light-secondary[_ngcontent-%COMP%]{background-color:#f8f9fa!important;border-color:#f8f9fa!important;color:#6c757d!important}.btn-light-secondary[_ngcontent-%COMP%]:hover{background-color:#e9ecef!important;border-color:#e9ecef!important;color:#495057!important}']})}return o})();var p=l(928);function R(o,s){1&o&&t.nrm(0,"span",15)}let D=(()=>{class o{productService;toastr;modal;product;ProductD=new t.bkB;isLoading;constructor(e,n,i){this.productService=e,this.toastr=n,this.modal=i}ngOnInit(){this.isLoading=this.productService.isLoading$}delete(){this.productService.deleteProduct(this.product.id).subscribe(e=>{this.ProductD.emit({message:200}),this.modal.close()})}static \u0275fac=function(n){return new(n||o)(t.rXU(b.b),t.rXU(f.tw),t.rXU(p.Lw))};static \u0275cmp=t.VBU({type:o,selectors:[["app-delete-product"]],inputs:{product:"product"},outputs:{ProductD:"ProductD"},decls:21,vars:4,consts:[[1,"modal-content"],["id","kt_modal_add_user_header",1,"modal-header"],[1,"fw-bolder"],["data-kt-users-modal-action","close",1,"btn","btn-icon","btn-sm","btn-active-icon-primary",3,"click"],[1,"svg-icon","svg-icon-1"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none"],["opacity","0.5","x","6","y","17.3137","width","16","height","2","rx","1","transform","rotate(-45 6 17.3137)","fill","currentColor"],["x","7.41422","y","6","width","16","height","2","rx","1","transform","rotate(45 7.41422 6)","fill","currentColor"],[1,"modal-body","scroll-y","mx-5","mx-xl-15","my-7"],["id","kt_modal_add_user_form","action","#",1,"form"],[1,"text-center","pt-15"],["type","reset",1,"btn","btn-light","me-3",3,"click"],["type","button","data-kt-users-modal-action","submit",1,"btn","btn-danger",3,"click"],[1,"indicator-label"],["class","spinner-border spinner-border-sm align-middle ms-2",4,"ngIf"],[1,"spinner-border","spinner-border-sm","align-middle","ms-2"]],template:function(n,i){1&n&&(t.j41(0,"div",0)(1,"div",1)(2,"h2",2),t.EFF(3),t.k0s(),t.j41(4,"div",3),t.bIt("click",function(){return i.modal.dismiss()}),t.j41(5,"span",4),t.qSk(),t.j41(6,"svg",5),t.nrm(7,"rect",6)(8,"rect",7),t.k0s()()()(),t.joV(),t.j41(9,"div",8)(10,"form",9)(11,"p"),t.EFF(12," \xbfESTAS SEGURO DE ELIMINAR ESTE PRODUCTO? "),t.k0s(),t.j41(13,"div",10)(14,"button",11),t.bIt("click",function(){return i.modal.dismiss()}),t.EFF(15,"Cerrar"),t.k0s(),t.j41(16,"button",12),t.bIt("click",function(){return i.delete()}),t.j41(17,"span",13),t.EFF(18,"ELIMINAR"),t.k0s(),t.DNE(19,R,1,0,"span",14),t.nI1(20,"async"),t.k0s()()()()()),2&n&&(t.R7$(3),t.SpI("Delete Product: #",i.product.title,""),t.R7$(16),t.Y8G("ngIf",t.bMT(20,2,i.isLoading)))},dependencies:[d.bT,c.qT,c.cb,c.cV,d.Jj]})}return o})();function $(o,s){if(1&o&&(t.j41(0,"div",34)(1,"div",35),t.nrm(2,"img",36),t.k0s()()),2&o){const e=t.XpG(2);t.R7$(2),t.Y8G("src",e.product.imagen,t.B4B)("alt",e.product.title)}}function G(o,s){if(1&o&&(t.j41(0,"div",37)(1,"strong",20),t.EFF(2,"Fecha de Expiraci\xf3n:"),t.k0s(),t.j41(3,"div",21),t.EFF(4),t.k0s()()),2&o){const e=t.XpG(2);t.R7$(4),t.JRh(e.formatDate(e.product.expires_at))}}function A(o,s){if(1&o&&(t.j41(0,"div",37)(1,"strong",20),t.EFF(2,"Tel\xe9fono:"),t.k0s(),t.j41(3,"div",21)(4,"a",38),t.nrm(5,"i",39),t.EFF(6),t.k0s()()()),2&o){const e=t.XpG(2);t.R7$(4),t.Y8G("href","tel:"+e.product.contact_phone,t.B4B),t.R7$(2),t.SpI(" ",e.product.contact_phone," ")}}function O(o,s){if(1&o&&(t.j41(0,"div",37)(1,"strong",20),t.EFF(2,"Email:"),t.k0s(),t.j41(3,"div",21)(4,"a",40),t.nrm(5,"i",41),t.EFF(6),t.k0s()()()),2&o){const e=t.XpG(2);t.R7$(4),t.Y8G("href","mailto:"+e.product.contact_email,t.B4B),t.R7$(2),t.SpI(" ",e.product.contact_email," ")}}function L(o,s){if(1&o&&(t.j41(0,"div",28)(1,"div",29)(2,"div",15)(3,"h5",16),t.nrm(4,"i",42),t.EFF(5," Descripci\xf3n "),t.k0s()(),t.j41(6,"div",18)(7,"p",43),t.EFF(8),t.k0s()()()()),2&o){const e=t.XpG(2);t.R7$(8),t.JRh(e.product.description)}}const N=function(o,s,e){return{"badge-success":o,"badge-danger":s,"badge-warning":e}},Y=function(o,s,e){return{"fa-check-circle":o,"fa-times-circle":s,"fa-pause-circle":e}};function U(o,s){if(1&o&&(t.j41(0,"div",11),t.DNE(1,$,3,2,"div",12),t.j41(2,"div",13)(3,"div",14)(4,"div",15)(5,"h5",16),t.nrm(6,"i",17),t.EFF(7," Informaci\xf3n B\xe1sica "),t.k0s()(),t.j41(8,"div",18)(9,"div",19)(10,"strong",20),t.EFF(11,"T\xedtulo:"),t.k0s(),t.j41(12,"div",21),t.EFF(13),t.k0s()(),t.j41(14,"div",19)(15,"strong",20),t.EFF(16,"SKU:"),t.k0s(),t.j41(17,"div",21),t.EFF(18),t.k0s()(),t.j41(19,"div",19)(20,"strong",20),t.EFF(21,"ID:"),t.k0s(),t.j41(22,"div",21),t.EFF(23),t.k0s()(),t.j41(24,"div",19)(25,"strong",20),t.EFF(26,"Precio:"),t.k0s(),t.j41(27,"div",22),t.EFF(28),t.k0s()()()()(),t.j41(29,"div",13)(30,"div",14)(31,"div",15)(32,"h5",16),t.nrm(33,"i",23),t.EFF(34," Estado y Ubicaci\xf3n "),t.k0s()(),t.j41(35,"div",18)(36,"div",19)(37,"strong",20),t.EFF(38,"Estado:"),t.k0s(),t.j41(39,"div")(40,"span",24),t.nrm(41,"i",25),t.EFF(42),t.k0s()()(),t.j41(43,"div",19)(44,"strong",20),t.EFF(45,"Ubicaci\xf3n:"),t.k0s(),t.j41(46,"div",21),t.EFF(47),t.k0s()(),t.j41(48,"div",19)(49,"strong",20),t.EFF(50,"Categor\xeda:"),t.k0s(),t.j41(51,"div",21),t.EFF(52),t.k0s()(),t.j41(53,"div",19)(54,"strong",20),t.EFF(55,"Vistas:"),t.k0s(),t.j41(56,"div",26),t.nrm(57,"i",27),t.EFF(58),t.k0s()()()()(),t.j41(59,"div",28)(60,"div",29)(61,"div",15)(62,"h5",16),t.nrm(63,"i",30),t.EFF(64," Fechas y Contacto "),t.k0s()(),t.j41(65,"div",18)(66,"div",31),t.DNE(67,G,5,1,"div",32),t.DNE(68,A,7,2,"div",32),t.DNE(69,O,7,2,"div",32),t.k0s()()()(),t.DNE(70,L,9,1,"div",33),t.k0s()),2&o){const e=t.XpG();t.R7$(1),t.Y8G("ngIf",e.product.imagen),t.R7$(12),t.JRh(e.product.title),t.R7$(5),t.JRh(e.product.sku),t.R7$(5),t.JRh(e.product.id),t.R7$(5),t.JRh(e.formatPrice(e.product.price_pen)),t.R7$(12),t.Y8G("ngClass",t.sMw(15,N,1===e.product.state,0===e.product.state,2===e.product.state)),t.R7$(1),t.Y8G("ngClass",t.sMw(19,Y,1===e.product.state,0===e.product.state,2===e.product.state)),t.R7$(1),t.SpI(" ",e.getStateText(e.product.state)," "),t.R7$(5),t.JRh(e.product.location),t.R7$(5),t.JRh((null==e.product.categorie_first?null:e.product.categorie_first.name)||"Sin categor\xeda"),t.R7$(6),t.SpI(" ",e.product.views_count||0," "),t.R7$(9),t.Y8G("ngIf",e.product.expires_at),t.R7$(1),t.Y8G("ngIf",e.product.contact_phone),t.R7$(1),t.Y8G("ngIf",e.product.contact_email),t.R7$(1),t.Y8G("ngIf",e.product.description)}}let X=(()=>{class o{activeModal;product;constructor(e){this.activeModal=e}formatPrice(e){return new Intl.NumberFormat("es-PE",{style:"currency",currency:"PEN",minimumFractionDigits:2}).format(e)}formatDate(e){return e?new Date(e).toLocaleDateString("es-PE",{year:"numeric",month:"long",day:"numeric"}):""}getStateText(e){switch(e){case 1:return"Activo";case 0:return"Inactivo";case 2:return"Pausado";default:return"Desconocido"}}editProduct(){this.activeModal.close({action:"edit",product:this.product})}static \u0275fac=function(n){return new(n||o)(t.rXU(p.Lw))};static \u0275cmp=t.VBU({type:o,selectors:[["app-product-details-modal"]],inputs:{product:"product"},decls:14,vars:1,consts:[[1,"modal-header","bg-primary"],[1,"modal-title","text-white"],[1,"fas","fa-info-circle","me-2"],["type","button","aria-label","Close",1,"btn-close","btn-close-white",3,"click"],[1,"modal-body"],["class","row g-4",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"fas","fa-times","me-2"],["type","button",1,"btn","btn-primary",3,"click"],[1,"fas","fa-edit","me-2"],[1,"row","g-4"],["class","col-12 text-center",4,"ngIf"],[1,"col-md-6"],[1,"card","h-100"],[1,"card-header"],[1,"card-title","mb-0"],[1,"fas","fa-info","text-primary","me-2"],[1,"card-body"],[1,"mb-3"],[1,"text-gray-700"],[1,"text-gray-800"],[1,"text-success","fs-4","fw-bold"],[1,"fas","fa-map-marker-alt","text-warning","me-2"],[1,"badge","fs-7",3,"ngClass"],[1,"fas","me-1",3,"ngClass"],[1,"text-primary","fs-5","fw-bold"],[1,"fas","fa-eye","me-1"],[1,"col-12"],[1,"card"],[1,"fas","fa-calendar","text-info","me-2"],[1,"row"],["class","col-md-4",4,"ngIf"],["class","col-12",4,"ngIf"],[1,"col-12","text-center"],[1,"symbol","symbol-150px","mx-auto","mb-4"],["onerror","this.src='/assets/media/svg/files/blank-image.svg'",1,"rounded",2,"width","150px","height","150px","object-fit","cover",3,"src","alt"],[1,"col-md-4"],[1,"text-success",3,"href"],[1,"fas","fa-phone","me-1"],[1,"text-primary",3,"href"],[1,"fas","fa-envelope","me-1"],[1,"fas","fa-file-text","text-dark","me-2"],[1,"text-gray-800","mb-0"]],template:function(n,i){1&n&&(t.j41(0,"div",0)(1,"h4",1),t.nrm(2,"i",2),t.EFF(3," Detalles del Anuncio "),t.k0s(),t.j41(4,"button",3),t.bIt("click",function(){return i.activeModal.dismiss()}),t.k0s()(),t.j41(5,"div",4),t.DNE(6,U,71,23,"div",5),t.k0s(),t.j41(7,"div",6)(8,"button",7),t.bIt("click",function(){return i.activeModal.dismiss()}),t.nrm(9,"i",8),t.EFF(10," Cerrar "),t.k0s(),t.j41(11,"button",9),t.bIt("click",function(){return i.editProduct()}),t.nrm(12,"i",10),t.EFF(13," Editar Anuncio "),t.k0s()()),2&n&&(t.R7$(6),t.Y8G("ngIf",i.product))},dependencies:[d.YU,d.bT],styles:[".modal-header[_ngcontent-%COMP%]{border-bottom:none}.modal-footer[_ngcontent-%COMP%]{border-top:none}.card[_ngcontent-%COMP%]{border:1px solid #e4e6ea;box-shadow:0 .1rem .75rem #0000000d}.card-header[_ngcontent-%COMP%]{background-color:#f8f9fa;border-bottom:1px solid #e4e6ea}"]})}return o})();var B=l(5964);function q(o,s){if(1&o&&(t.qex(0),t.j41(1,"option",78),t.EFF(2),t.k0s(),t.bVm()),2&o){const e=s.$implicit;t.R7$(1),t.Y8G("value",e.id),t.R7$(1),t.JRh(e.name)}}function z(o,s){if(1&o&&(t.j41(0,"span",111),t.nrm(1,"i",112),t.EFF(2),t.k0s()),2&o){const e=t.XpG().$implicit;t.R7$(2),t.SpI(" ",e.categorie_first.name," ")}}function J(o,s){1&o&&(t.j41(0,"span",113),t.EFF(1," Sin categor\xeda "),t.k0s())}const K=function(o,s,e){return{"text-success":o,"text-warning":s,"text-danger":e}},H=function(o,s,e){return{"badge-light-success":o,"badge-light-warning":s,"badge-light-danger":e}};function Q(o,s){if(1&o&&(t.j41(0,"div")(1,"div",114),t.EFF(2),t.k0s(),t.j41(3,"span",115),t.nrm(4,"i",116),t.EFF(5),t.k0s()()),2&o){const e=t.XpG().$implicit,n=t.XpG();t.R7$(1),t.Y8G("ngClass",t.sMw(4,K,"active"===n.getExpirationStatus(e.expires_at),"warning"===n.getExpirationStatus(e.expires_at),"expired"===n.getExpirationStatus(e.expires_at))),t.R7$(1),t.SpI(" ",n.formatDate(e.expires_at)," "),t.R7$(1),t.Y8G("ngClass",t.sMw(8,H,"active"===n.getExpirationStatus(e.expires_at),"warning"===n.getExpirationStatus(e.expires_at),"expired"===n.getExpirationStatus(e.expires_at))),t.R7$(2),t.SpI(" ",n.getExpirationText(e.expires_at)," ")}}function W(o,s){1&o&&(t.j41(0,"span",113),t.EFF(1," Sin fecha "),t.k0s())}const Z=function(o,s,e){return{"badge-light-success":o,"badge-light-danger":s,"badge-light-warning":e}},tt=function(o,s,e){return{"fa-check-circle":o,"fa-times-circle":s,"fa-pause-circle":e}},et=function(o){return["/products/list/edit",o]};function it(o,s){if(1&o){const e=t.RV6();t.j41(0,"tr")(1,"td",79)(2,"div",3)(3,"div",80),t.nrm(4,"img",81),t.k0s(),t.j41(5,"div",82)(6,"a",83),t.EFF(7),t.k0s(),t.j41(8,"span",84),t.EFF(9),t.k0s(),t.j41(10,"span",85),t.EFF(11),t.k0s()()()(),t.j41(12,"td",86)(13,"div",87),t.EFF(14),t.k0s(),t.j41(15,"span",88),t.EFF(16,"PEN"),t.k0s()(),t.j41(17,"td",79),t.DNE(18,z,3,1,"span",89),t.DNE(19,J,2,0,"span",90),t.k0s(),t.j41(20,"td",79)(21,"div",3),t.nrm(22,"i",68),t.j41(23,"span",91),t.EFF(24),t.k0s()()(),t.j41(25,"td",86),t.DNE(26,Q,6,12,"div",92),t.DNE(27,W,2,0,"span",90),t.k0s(),t.j41(28,"td",86)(29,"div",93),t.nrm(30,"i",72),t.j41(31,"span",94),t.EFF(32),t.k0s()()(),t.j41(33,"td",86)(34,"span",95),t.nrm(35,"i",96),t.EFF(36),t.k0s()(),t.j41(37,"td",97)(38,"div",98)(39,"button",99),t.nrm(40,"i",100),t.k0s(),t.j41(41,"div",101)(42,"h6",102),t.nrm(43,"i",103),t.EFF(44," Acciones disponibles "),t.k0s(),t.j41(45,"a",104),t.nrm(46,"i",105),t.EFF(47," Editar Anuncio "),t.k0s(),t.nrm(48,"div",106),t.j41(49,"a",107),t.bIt("click",function(){const a=t.eBV(e).$implicit,r=t.XpG();return t.Njj(r.viewDetails(a))}),t.nrm(50,"i",108),t.EFF(51," Ver Detalles "),t.k0s(),t.nrm(52,"div",106),t.j41(53,"a",109),t.bIt("click",function(){const i=t.eBV(e),a=i.$implicit,r=i.index,E=t.XpG();return t.Njj(E.delete(a.id,r))}),t.nrm(54,"i",110),t.EFF(55," Eliminar "),t.k0s()()()()()}if(2&o){const e=s.$implicit,n=t.XpG();t.R7$(4),t.Y8G("src",e.imagen,t.B4B)("alt",e.title),t.R7$(3),t.SpI(" ",n.truncateText(e.title,40)," "),t.R7$(2),t.SpI(" SKU: ",e.sku," "),t.R7$(2),t.SpI(" ID: ",e.id," "),t.R7$(3),t.SpI(" ",n.formatPrice(e.price_pen)," "),t.R7$(4),t.Y8G("ngIf",e.categorie_first),t.R7$(1),t.Y8G("ngIf",!e.categorie_first),t.R7$(5),t.SpI(" ",n.truncateText(e.location,25)," "),t.R7$(2),t.Y8G("ngIf",e.expires_at),t.R7$(1),t.Y8G("ngIf",!e.expires_at),t.R7$(5),t.SpI(" ",e.views_count||0," "),t.R7$(2),t.Y8G("ngClass",t.sMw(16,Z,1===e.state,0===e.state,2===e.state)),t.R7$(1),t.Y8G("ngClass",t.sMw(20,tt,1===e.state,0===e.state,2===e.state)),t.R7$(1),t.SpI(" ",n.getStateText(e.state)," "),t.R7$(9),t.Y8G("routerLink",t.eq3(24,et,e.id))}}const j=function(){return["/products/register"]};function nt(o,s){1&o&&(t.j41(0,"div",117)(1,"div",118)(2,"div",119)(3,"div",5),t.nrm(4,"i",120),t.k0s()(),t.j41(5,"h3",121),t.EFF(6,"No se encontraron anuncios"),t.k0s(),t.j41(7,"p",122),t.EFF(8," No hay anuncios que coincidan con los filtros aplicados."),t.nrm(9,"br"),t.EFF(10," Intenta ajustar los criterios de b\xfasqueda o crear un nuevo anuncio. "),t.k0s(),t.j41(11,"button",15),t.nrm(12,"i",123),t.EFF(13," Crear Primer Anuncio "),t.k0s()()()),2&o&&(t.R7$(11),t.Y8G("routerLink",t.lJ4(1,j)))}function ot(o,s){if(1&o&&(t.j41(0,"div",124)(1,"div",125)(2,"div",126)(3,"label",127),t.EFF(4),t.k0s()()(),t.j41(5,"div",128)(6,"div",129)(7,"ul",130)(8,"li",131)(9,"a",132),t.nrm(10,"i",133),t.k0s()(),t.j41(11,"li",134)(12,"a",132),t.EFF(13,"1"),t.k0s()(),t.j41(14,"li",135)(15,"a",132),t.nrm(16,"i",136),t.k0s()()()()()()),2&o){const e=t.XpG();t.R7$(4),t.SpI(" Mostrando ",e.products.length," anuncios ")}}let at=(()=>{class o{productService;modalService;toastr;route;router;products=[];search="";totalPages=0;currentPage=1;isLoading$;categorie_first_id="";categories_first=[];routerSubscription;constructor(e,n,i,a,r){this.productService=e,this.modalService=n,this.toastr=i,this.route=a,this.router=r}ngOnInit(){this.isLoading$=this.productService.isLoading$,this.configAll(),setTimeout(()=>{this.listProducts()},200),this.routerSubscription=this.router.events.pipe((0,B.p)(e=>e instanceof _.wF)).subscribe(e=>{e.url.includes("/products/list")&&(console.log("Navegando al listado, refrescando..."),setTimeout(()=>{this.listProducts()},100))})}ngOnDestroy(){this.routerSubscription&&this.routerSubscription.unsubscribe()}configAll(){console.log("\u{1f504} Cargando configuraci\xf3n de anuncios..."),this.productService.configAll().subscribe({next:e=>{console.log("\u2705 Configuraci\xf3n listado anuncios cargada:",e),this.categories_first=e.categories||[],console.log("\u{1f4cb} Configuraci\xf3n lista, cargando productos...")},error:e=>{console.error("\u274c Error al cargar configuraci\xf3n de anuncios:",e),this.toastr.error("Error","No se pudo cargar la configuraci\xf3n de anuncios"),this.categories_first=[]}})}listProducts(e=1){this.productService.listProducts(e,{search:this.search,categorie_id:this.categorie_first_id}).subscribe({next:i=>{console.log("Respuesta de anuncios:",i),this.products=i.products.data,this.totalPages=i.total,this.currentPage=e},error:i=>{console.error("Error al cargar anuncios:",i),403===i.status?this.toastr.error("Permisos","No tienes permisos para ver los anuncios"):this.toastr.error("Error",i.error?.message||"Error al cargar anuncios")}})}searchTo(){this.listProducts()}searchProducts(){this.listProducts()}refreshList(){console.log("Refrescando lista manualmente..."),this.listProducts(),this.toastr.info("Lista actualizada","Los anuncios se han refrescado")}resetFilters(){this.search="",this.categorie_first_id="",this.listProducts()}loadPage(e){console.log(e),this.listProducts(e)}deleteProduct(e){const n=this.modalService.open(D,{centered:!0,size:"md"});n.componentInstance.product=e,n.componentInstance.ProductD.subscribe(i=>{let a=this.products.findIndex(r=>r.id==e.id);-1!=a&&this.products.splice(a,1)})}delete(e,n){confirm("\xbfEst\xe1s seguro de que deseas eliminar este anuncio?")&&this.productService.deleteProduct(e).subscribe({next:i=>{console.log("Anuncio eliminado:",i),this.products.splice(n,1),this.toastr.success("\xc9xito","Anuncio eliminado correctamente"),this.notifyDashboardUpdate()},error:i=>{console.error("Error al eliminar anuncio:",i),this.toastr.error("Error","No se pudo eliminar el anuncio")}})}notifyDashboardUpdate(){localStorage.setItem("dashboard_needs_update","true"),window.dispatchEvent(new CustomEvent("anuncio-deleted"))}formatPrice(e){return new Intl.NumberFormat("es-PE",{style:"currency",currency:"PEN",minimumFractionDigits:2}).format(e)}formatDate(e){return e?new Date(e).toLocaleDateString("es-PE",{year:"numeric",month:"short",day:"numeric"}):""}getExpirationStatus(e){if(!e)return"none";const n=new Date(e),i=new Date,a=n.getTime()-i.getTime(),r=Math.ceil(a/864e5);return r<0?"expired":r<=7?"warning":"active"}truncateText(e,n=100){return e?e.length>n?e.substring(0,n)+"...":e:""}getActiveCount(){return this.products.filter(e=>1===e.state).length}getPendingCount(){return this.products?this.products.filter(e=>{if(!e.expires_at)return!1;const n=new Date(e.expires_at),i=new Date,a=n.getTime()-i.getTime(),r=Math.ceil(a/864e5);return r<=7&&r>=0}).length:0}getTotalViews(){return this.products?this.products.reduce((e,n)=>e+(n.views_count||0),0):0}getExpirationText(e){if(!e)return"Sin fecha";const n=new Date(e),i=new Date,a=n.getTime()-i.getTime(),r=Math.ceil(a/864e5);return r<0?"Expirado":`${r} d\xedas`}getStateText(e){switch(e){case 1:return"Activo";case 0:return"Inactivo";case 2:return"Pausado";default:return"Desconocido"}}viewDetails(e){const n=this.modalService.open(X,{centered:!0,size:"xl",backdrop:"static",keyboard:!1});n.componentInstance.product=e,n.result.then(i=>{"edit"===i?.action&&this.router.navigate(["/products/list/edit",e.id])}).catch(i=>{console.log("Modal cerrado")})}static \u0275fac=function(n){return new(n||o)(t.rXU(b.b),t.rXU(p.Bq),t.rXU(f.tw),t.rXU(_.nX),t.rXU(_.Ix))};static \u0275cmp=t.VBU({type:o,selectors:[["app-lits-products"]],decls:138,vars:16,consts:[[1,"card","shadow-sm"],[1,"card-header","bg-gradient-primary","border-0","pt-6"],[1,"card-title"],[1,"d-flex","align-items-center"],[1,"symbol","symbol-50px","me-3"],[1,"symbol-label","bg-light-primary"],[1,"fas","fa-bullhorn","text-primary","fs-2x"],[1,"fw-bold","text-white","mb-1"],[1,"text-white-50","mb-0"],[1,"card-toolbar"],["data-kt-customer-table-toolbar","base",1,"d-flex","justify-content-end"],["type","button",1,"btn","btn-light-primary","me-3"],[1,"fas","fa-file-export","fs-2"],["type","button","title","Refrescar lista",1,"btn","btn-light-info","me-3",3,"click"],[1,"fas","fa-sync-alt","me-2"],["type","button",1,"btn","btn-primary",3,"routerLink"],[1,"fas","fa-plus","fs-2"],[1,"card-body","pt-0"],[1,"card","bg-light-info","border-info","border-dashed","mb-8"],[1,"card-body","p-6"],[1,"d-flex","align-items-center","mb-4"],[1,"fas","fa-search","text-info","fs-2x","me-3"],[1,"fw-bold","text-gray-800","mb-1"],[1,"text-muted","mb-0"],[1,"row","g-4"],[1,"col-xl-6","col-lg-6"],[1,"form-label","fw-bold","text-gray-700"],[1,"fas","fa-search","text-primary","me-2"],[1,"input-group"],[1,"input-group-text","bg-light-primary"],[1,"fas","fa-search","text-primary"],["type","text","placeholder","Buscar por t\xedtulo, descripci\xf3n, ubicaci\xf3n...",1,"form-control","form-control-solid",3,"ngModel","ngModelChange","keyup.enter"],["type","button",1,"btn","btn-primary",3,"click"],[1,"col-xl-4","col-lg-6"],[1,"fas","fa-layer-group","text-success","me-2"],[1,"form-select","form-select-solid",3,"ngModel","ngModelChange","change"],["value",""],[4,"ngFor","ngForOf"],[1,"col-xl-2","col-lg-12","d-flex","align-items-end"],["type","button",1,"btn","btn-light-warning","w-100",3,"click"],[1,"fas","fa-eraser","me-2"],[1,"row","mb-8"],[1,"col-xl-3","col-lg-6"],[1,"card","bg-light-success","border-0"],[1,"symbol-label","bg-success"],[1,"fas","fa-check-circle","text-white","fs-2x"],[1,"fs-2hx","fw-bold","text-gray-800"],[1,"fs-7","fw-semibold","text-gray-400"],[1,"card","bg-light-warning","border-0"],[1,"symbol-label","bg-warning"],[1,"fas","fa-clock","text-white","fs-2x"],[1,"card","bg-light-info","border-0"],[1,"symbol-label","bg-info"],[1,"fas","fa-eye","text-white","fs-2x"],[1,"card","bg-light-primary","border-0"],[1,"symbol-label","bg-primary"],[1,"fas","fa-bullhorn","text-white","fs-2x"],[1,"table-responsive"],["id","kt_customers_table",1,"table","table-striped","table-row-bordered","gy-5","gs-7"],[1,"bg-light-primary"],[1,"fw-semibold","fs-6","text-gray-800"],[1,"min-w-200px"],[1,"fas","fa-bullhorn","text-primary","me-2"],[1,"min-w-100px","text-center"],[1,"fas","fa-dollar-sign","text-success","me-2"],[1,"min-w-120px"],[1,"fas","fa-layer-group","text-info","me-2"],[1,"min-w-150px"],[1,"fas","fa-map-marker-alt","text-warning","me-2"],[1,"min-w-120px","text-center"],[1,"fas","fa-calendar-alt","text-danger","me-2"],[1,"min-w-80px","text-center"],[1,"fas","fa-eye","text-primary","me-2"],[1,"fas","fa-toggle-on","text-success","me-2"],[1,"fas","fa-tools","text-gray-600","me-2"],[1,"fw-semibold","text-gray-600"],["class","text-center py-15",4,"ngIf"],["class","row mt-8",4,"ngIf"],[3,"value"],[1,"pe-0"],[1,"symbol","symbol-60px","me-4"],["onerror","this.src='/assets/media/svg/files/blank-image.svg'",1,"rounded",2,"width","60px","height","60px","object-fit","cover",3,"src","alt"],[1,"flex-grow-1"],["href","#",1,"text-gray-800","text-hover-primary","fs-6","fw-bold","mb-1","d-block"],[1,"text-muted","fw-semibold","d-block","fs-7"],[1,"badge","badge-light-primary","fs-8"],[1,"text-center","pe-0"],[1,"fw-bold","text-success","fs-5"],[1,"text-muted","fs-7"],["class","badge badge-light-info fw-bold fs-7",4,"ngIf"],["class","text-muted fs-8",4,"ngIf"],[1,"fw-semibold"],[4,"ngIf"],[1,"d-flex","align-items-center","justify-content-center"],[1,"fw-bold","text-gray-800","fs-6"],[1,"badge","fs-7",3,"ngClass"],[1,"fas","me-1",3,"ngClass"],[1,"text-center","position-relative"],["ngbDropdown","","placement","bottom-right",1,"d-inline-block"],["type","button","ngbDropdownToggle","","aria-label","M\xe1s acciones",1,"btn","btn-light","btn-active-light-primary","btn-sm"],[1,"fas","fa-ellipsis-v"],["ngbDropdownMenu","",1,"dropdown-menu","dropdown-menu-end","shadow-lg"],[1,"dropdown-header"],[1,"fas","fa-cog","me-2"],[1,"dropdown-item","d-flex","align-items-center",3,"routerLink"],[1,"fas","fa-edit","text-primary","me-3"],[1,"dropdown-divider"],["href","javascript:void(0)",1,"dropdown-item","d-flex","align-items-center",3,"click"],[1,"fas","fa-eye","text-info","me-3"],["href","javascript:void(0)",1,"dropdown-item","d-flex","align-items-center","text-danger",3,"click"],[1,"fas","fa-trash-alt","text-danger","me-3"],[1,"badge","badge-light-info","fw-bold","fs-7"],[1,"fas","fa-tag","me-1"],[1,"text-muted","fs-8"],[1,"fw-semibold",3,"ngClass"],[1,"badge","fs-8",3,"ngClass"],[1,"fas","fa-clock","me-1"],[1,"text-center","py-15"],[1,"d-flex","flex-column"],[1,"symbol","symbol-100px","mx-auto","mb-7"],[1,"fas","fa-search","fs-2x","text-primary"],[1,"fw-bold","text-gray-800","mb-5"],[1,"text-muted","fs-6","mb-8"],[1,"fas","fa-plus","me-2"],[1,"row","mt-8"],[1,"col-sm-12","col-md-5","d-flex","align-items-center","justify-content-center","justify-content-md-start"],[1,"dataTables_length"],[1,"fw-semibold","text-gray-700"],[1,"col-sm-12","col-md-7","d-flex","align-items-center","justify-content-center","justify-content-md-end"],["id","kt_customers_table_paginate",1,"dataTables_paginate","paging_simple_numbers"],[1,"pagination"],[1,"paginate_button","page-item","previous","disabled"],["href","#",1,"page-link"],[1,"previous"],[1,"paginate_button","page-item","active"],[1,"paginate_button","page-item","next","disabled"],[1,"next"]],template:function(n,i){1&n&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),t.nrm(6,"i",6),t.k0s()(),t.j41(7,"div")(8,"h3",7),t.EFF(9," Gesti\xf3n de Anuncios "),t.k0s(),t.j41(10,"p",8),t.EFF(11,"Administra todos los anuncios de AvisOnline"),t.k0s()()()(),t.j41(12,"div",9)(13,"div",10)(14,"button",11),t.nrm(15,"i",12),t.EFF(16," Exportar "),t.k0s(),t.j41(17,"button",13),t.bIt("click",function(){return i.refreshList()}),t.j41(18,"i",14),t.nI1(19,"async"),t.k0s(),t.EFF(20," Refrescar "),t.k0s(),t.j41(21,"button",15),t.nrm(22,"i",16),t.EFF(23," Nuevo Anuncio "),t.k0s()()()(),t.j41(24,"div",17)(25,"div",18)(26,"div",19)(27,"div",20),t.nrm(28,"i",21),t.j41(29,"div")(30,"h5",22),t.EFF(31,"Filtros de B\xfasqueda"),t.k0s(),t.j41(32,"p",23),t.EFF(33,"Encuentra anuncios espec\xedficos r\xe1pidamente"),t.k0s()()(),t.j41(34,"div",24)(35,"div",25)(36,"label",26),t.nrm(37,"i",27),t.EFF(38," Buscar Anuncio "),t.k0s(),t.j41(39,"div",28)(40,"span",29),t.nrm(41,"i",30),t.k0s(),t.j41(42,"input",31),t.bIt("ngModelChange",function(r){return i.search=r})("keyup.enter",function(){return i.searchProducts()}),t.k0s(),t.j41(43,"button",32),t.bIt("click",function(){return i.searchProducts()}),t.EFF(44," Buscar "),t.k0s()()(),t.j41(45,"div",33)(46,"label",26),t.nrm(47,"i",34),t.EFF(48," Filtrar por Categor\xeda "),t.k0s(),t.j41(49,"select",35),t.bIt("ngModelChange",function(r){return i.categorie_first_id=r})("change",function(){return i.searchProducts()}),t.j41(50,"option",36),t.EFF(51,"\u{1f3f7}\ufe0f Todas las categor\xedas"),t.k0s(),t.DNE(52,q,3,2,"ng-container",37),t.k0s()(),t.j41(53,"div",38)(54,"button",39),t.bIt("click",function(){return i.resetFilters()}),t.nrm(55,"i",40),t.EFF(56," Limpiar "),t.k0s()()()()(),t.j41(57,"div",41)(58,"div",42)(59,"div",43)(60,"div",19)(61,"div",3)(62,"div",4)(63,"div",44),t.nrm(64,"i",45),t.k0s()(),t.j41(65,"div")(66,"div",46),t.EFF(67),t.k0s(),t.j41(68,"div",47),t.EFF(69,"Anuncios Activos"),t.k0s()()()()()(),t.j41(70,"div",42)(71,"div",48)(72,"div",19)(73,"div",3)(74,"div",4)(75,"div",49),t.nrm(76,"i",50),t.k0s()(),t.j41(77,"div")(78,"div",46),t.EFF(79),t.k0s(),t.j41(80,"div",47),t.EFF(81,"Por Expirar"),t.k0s()()()()()(),t.j41(82,"div",42)(83,"div",51)(84,"div",19)(85,"div",3)(86,"div",4)(87,"div",52),t.nrm(88,"i",53),t.k0s()(),t.j41(89,"div")(90,"div",46),t.EFF(91),t.k0s(),t.j41(92,"div",47),t.EFF(93,"Total Vistas"),t.k0s()()()()()(),t.j41(94,"div",42)(95,"div",54)(96,"div",19)(97,"div",3)(98,"div",4)(99,"div",55),t.nrm(100,"i",56),t.k0s()(),t.j41(101,"div")(102,"div",46),t.EFF(103),t.k0s(),t.j41(104,"div",47),t.EFF(105,"Total Anuncios"),t.k0s()()()()()()(),t.j41(106,"div",57)(107,"table",58)(108,"thead",59)(109,"tr",60)(110,"th",61),t.nrm(111,"i",62),t.EFF(112," Anuncio "),t.k0s(),t.j41(113,"th",63),t.nrm(114,"i",64),t.EFF(115," Precio "),t.k0s(),t.j41(116,"th",65),t.nrm(117,"i",66),t.EFF(118," Categor\xeda "),t.k0s(),t.j41(119,"th",67),t.nrm(120,"i",68),t.EFF(121," Ubicaci\xf3n "),t.k0s(),t.j41(122,"th",69),t.nrm(123,"i",70),t.EFF(124," Expiraci\xf3n "),t.k0s(),t.j41(125,"th",71),t.nrm(126,"i",72),t.EFF(127," Vistas "),t.k0s(),t.j41(128,"th",63),t.nrm(129,"i",73),t.EFF(130," Estado "),t.k0s(),t.j41(131,"th",69),t.nrm(132,"i",74),t.EFF(133," Acciones "),t.k0s()()(),t.j41(134,"tbody",75),t.DNE(135,it,56,26,"tr",37),t.k0s()(),t.DNE(136,nt,14,2,"div",76),t.k0s(),t.DNE(137,ot,17,1,"div",77),t.k0s()()),2&n&&(t.R7$(18),t.AVh("fa-spin",t.bMT(19,13,i.isLoading$)),t.R7$(3),t.Y8G("routerLink",t.lJ4(15,j)),t.R7$(21),t.Y8G("ngModel",i.search),t.R7$(7),t.Y8G("ngModel",i.categorie_first_id),t.R7$(3),t.Y8G("ngForOf",i.categories_first),t.R7$(15),t.JRh(i.getActiveCount()),t.R7$(12),t.JRh(i.getPendingCount()),t.R7$(12),t.JRh(i.getTotalViews()),t.R7$(12),t.JRh(i.products.length),t.R7$(32),t.Y8G("ngForOf",i.products),t.R7$(1),t.Y8G("ngIf",0===i.products.length),t.R7$(1),t.Y8G("ngIf",i.products.length>0))},dependencies:[d.YU,d.Sq,d.bT,_.Wk,c.xH,c.y7,c.me,c.wz,c.BC,c.vS,p.tg,p.do,p.U0,d.Jj],styles:['@charset "UTF-8";[_nghost-%COMP%]     .table-responsive{overflow:visible!important}[_nghost-%COMP%]     .dropdown{position:static!important}[_nghost-%COMP%]     .dropdown-menu{position:absolute!important;z-index:1050!important;min-width:200px!important;box-shadow:0 .5rem 1rem #00000026!important;border:1px solid rgba(0,0,0,.15)!important;border-radius:.375rem!important}[_nghost-%COMP%]     .dropdown-menu.dropdown-menu-end{right:0!important;left:auto!important}[_nghost-%COMP%]     .btn[ngbDropdownToggle]{border:1px solid #e4e6ea!important;background-color:#f5f8fa!important}[_nghost-%COMP%]     .btn[ngbDropdownToggle]:hover{background-color:#e9ecef!important;border-color:#adb5bd!important}[_nghost-%COMP%]     .btn[ngbDropdownToggle]:focus{box-shadow:0 0 0 .2rem #007bff40!important}[_nghost-%COMP%]     .dropdown-item{padding:.5rem 1rem!important;font-size:.875rem!important}[_nghost-%COMP%]     .dropdown-item:hover{background-color:#f8f9fa!important}[_nghost-%COMP%]     .dropdown-item i{width:1.25rem!important;text-align:center!important}[_nghost-%COMP%]     .dropdown-header{padding:.5rem 1rem!important;font-size:.75rem!important;font-weight:600!important;color:#6c757d!important;background-color:#f8f9fa!important;border-bottom:1px solid #dee2e6!important}[_nghost-%COMP%]     .dropdown-divider{margin:.25rem 0!important}.table-responsive[_ngcontent-%COMP%]{padding-bottom:1rem!important}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{vertical-align:middle!important;padding:1rem .75rem!important}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{position:relative!important;overflow:visible!important}@media (max-width: 768px){[_nghost-%COMP%]     .dropdown-menu{min-width:180px!important;font-size:.8rem!important}}']})}return o})();function rt(o,s){1&o&&t.nrm(0,"span",15)}let st=(()=>{class o{productImagenService;toastr;modal;id;ImagenD=new t.bkB;isLoading;constructor(e,n,i){this.productImagenService=e,this.toastr=n,this.modal=i}ngOnInit(){this.isLoading=this.productImagenService.isLoading$}delete(){this.productImagenService.deleteImageProduct(this.id).subscribe(e=>{this.ImagenD.emit({message:200}),this.modal.close()})}static \u0275fac=function(n){return new(n||o)(t.rXU(b.b),t.rXU(f.tw),t.rXU(p.Lw))};static \u0275cmp=t.VBU({type:o,selectors:[["app-delete-imagen-add"]],inputs:{id:"id"},outputs:{ImagenD:"ImagenD"},decls:21,vars:4,consts:[[1,"modal-content"],["id","kt_modal_add_user_header",1,"modal-header"],[1,"fw-bolder"],["data-kt-users-modal-action","close",1,"btn","btn-icon","btn-sm","btn-active-icon-primary",3,"click"],[1,"svg-icon","svg-icon-1"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none"],["opacity","0.5","x","6","y","17.3137","width","16","height","2","rx","1","transform","rotate(-45 6 17.3137)","fill","currentColor"],["x","7.41422","y","6","width","16","height","2","rx","1","transform","rotate(45 7.41422 6)","fill","currentColor"],[1,"modal-body","scroll-y","mx-5","mx-xl-15","my-7"],["id","kt_modal_add_user_form","action","#",1,"form"],[1,"text-center","pt-15"],["type","reset",1,"btn","btn-light","me-3",3,"click"],["type","button","data-kt-users-modal-action","submit",1,"btn","btn-danger",3,"click"],[1,"indicator-label"],["class","spinner-border spinner-border-sm align-middle ms-2",4,"ngIf"],[1,"spinner-border","spinner-border-sm","align-middle","ms-2"]],template:function(n,i){1&n&&(t.j41(0,"div",0)(1,"div",1)(2,"h2",2),t.EFF(3),t.k0s(),t.j41(4,"div",3),t.bIt("click",function(){return i.modal.dismiss()}),t.j41(5,"span",4),t.qSk(),t.j41(6,"svg",5),t.nrm(7,"rect",6)(8,"rect",7),t.k0s()()()(),t.joV(),t.j41(9,"div",8)(10,"form",9)(11,"p"),t.EFF(12," \xbfESTAS SEGURO DE ELIMINAR ESTA IMAGEN? "),t.k0s(),t.j41(13,"div",10)(14,"button",11),t.bIt("click",function(){return i.modal.dismiss()}),t.EFF(15,"Cerrar"),t.k0s(),t.j41(16,"button",12),t.bIt("click",function(){return i.delete()}),t.j41(17,"span",13),t.EFF(18,"ELIMINAR"),t.k0s(),t.DNE(19,rt,1,0,"span",14),t.nI1(20,"async"),t.k0s()()()()()),2&n&&(t.R7$(3),t.SpI("Delete Imagen Add: #",i.id,""),t.R7$(16),t.Y8G("ngIf",t.bMT(20,2,i.isLoading)))},dependencies:[d.bT,c.qT,c.cb,c.cV,d.Jj]})}return o})();function ct(o,s){1&o&&(t.j41(0,"div",101)(1,"span",102),t.EFF(2,"Cargando..."),t.k0s()())}function dt(o,s){if(1&o&&(t.qex(0),t.j41(1,"option",68),t.EFF(2),t.k0s(),t.bVm()),2&o){const e=s.$implicit;t.R7$(1),t.Y8G("value",e.id),t.R7$(1),t.JRh(e.name)}}function lt(o,s){if(1&o&&(t.j41(0,"div",41)(1,"div",24),t.nrm(2,"input",103),t.j41(3,"label",104),t.EFF(4,"Fecha de expiraci\xf3n"),t.k0s()(),t.j41(5,"div",28),t.EFF(6," La fecha en que expira este anuncio "),t.k0s()()),2&o){const e=t.XpG();t.R7$(2),t.Y8G("value",e.formatDate(null==e.PRODUCT_SELECTED?null:e.PRODUCT_SELECTED.expires_at))}}function pt(o,s){1&o&&(t.j41(0,"div",105)(1,"div",106)(2,"small",107),t.EFF(3,"Imagen Actual"),t.k0s()()())}function ut(o,s){if(1&o){const e=t.RV6();t.j41(0,"div")(1,"ng-multiselect-dropdown",108),t.bIt("ngModelChange",function(i){t.eBV(e);const a=t.XpG();return t.Njj(a.selectedItems=i)})("onSelect",function(i){t.eBV(e);const a=t.XpG();return t.Njj(a.onItemSelect(i))})("onSelectAll",function(i){t.eBV(e);const a=t.XpG();return t.Njj(a.onSelectAll(i))}),t.k0s()()}if(2&o){const e=t.XpG();t.R7$(1),t.Y8G("placeholder","Etiquetas disponibles")("settings",e.dropdownSettings)("data",e.dropdownList)("ngModel",e.selectedItems)}}function mt(o,s){1&o&&(t.j41(0,"span"),t.EFF(1,"Guardar Cambios"),t.k0s())}function gt(o,s){1&o&&(t.j41(0,"span"),t.EFF(1,"Guardando..."),t.k0s())}let _t=(()=>{class o{productService;toastr;activedRoute;router;modalService;title="";sku="";price_pen=0;description="";imagen_previsualiza="https://preview.keenthemes.com/metronic8/demo1/assets/media/svg/illustrations/easy/2.svg";file_imagen=null;state=1;location="";contact_phone="";contact_email="";expires_at="";views_count=0;isLoading$;categorie_first_id="";categories_first=[];dropdownList=[];selectedItems=[];dropdownSettings={};word="";isShowMultiselect=!1;PRODUCT_ID="";PRODUCT_SELECTED;imagen_add;imagen_add_previsualiza="https://preview.keenthemes.com/metronic8/demo1/assets/media/svg/illustrations/easy/2.svg";images_files=[];allowedImageTypes=["image/jpeg","image/jpg","image/png","image/gif","image/bmp","image/webp"];constructor(e,n,i,a,r){this.productService=e,this.toastr=n,this.activedRoute=i,this.router=a,this.modalService=r}ngOnInit(){this.isLoading$=this.productService.isLoading$,this.dropdownSettings={singleSelection:!1,idField:"item_id",textField:"item_text",selectAllText:"Seleccionar Todo",unSelectAllText:"Deseleccionar Todo",allowSearchFilter:!0},this.activedRoute.params.subscribe(e=>{this.PRODUCT_ID=e.id}),this.configAll()}configAll(){this.productService.configAll().subscribe({next:e=>{console.log("Configuraci\xf3n editar anuncio cargada:",e),this.categories_first=e.categories||[],this.showProduct()},error:e=>{console.error("Error al cargar configuraci\xf3n en editar anuncio:",e),this.toastr.error("Error","No se pudo cargar la configuraci\xf3n necesaria")}})}showProduct(){this.productService.showProduct(this.PRODUCT_ID).subscribe({next:e=>{console.log("Datos del anuncio cargados:",e),this.PRODUCT_SELECTED=e.product,this.title=e.product.title||"",this.sku=e.product.sku||"",this.price_pen=e.product.price_pen||0,this.description=e.product.description||"",this.imagen_previsualiza=e.product.imagen||this.imagen_previsualiza,this.state=e.product.state||1,this.location=e.product.location||"",this.contact_phone=e.product.contact_phone||"",this.contact_email=e.product.contact_email||"",this.expires_at=e.product.expires_at?e.product.expires_at.split(" ")[0]:"",this.views_count=e.product.views_count||0,this.categorie_first_id=e.product.categorie_first_id||"",this.selectedItems=e.product.tags||[],this.dropdownList=e.product.tags||[],this.images_files=e.product.images||[]},error:e=>{console.error("Error al cargar el anuncio:",e),this.toastr.error("Error","No se pudo cargar el anuncio")}})}addItems(){if(!this.word||""===this.word.trim())return void this.toastr.error("Validaci\xf3n","Debe ingresar una etiqueta");this.isShowMultiselect=!0;const e=(new Date).getTime();this.dropdownList.push({item_id:e,item_text:this.word}),this.selectedItems.push({item_id:e,item_text:this.word}),setTimeout(()=>{this.word="",this.isShowMultiselect=!1,this.isLoadingView()},100)}processFile(e){if(!e.target.files||!e.target.files[0])return void this.toastr.error("Validaci\xf3n","No se seleccion\xf3 ninguna imagen");const n=e.target.files[0];if(!this.allowedImageTypes.includes(n.type.toLowerCase()))return this.toastr.error("Validaci\xf3n",`Tipo de archivo no v\xe1lido. Solo se permiten: ${this.allowedImageTypes.join(", ").replace(/image\//g,"").toUpperCase()}`),void(e.target.value="");if(n.size>5242880)return this.toastr.error("Validaci\xf3n","El archivo es demasiado grande. Tama\xf1o m\xe1ximo: 5MB"),void(e.target.value="");this.file_imagen=n;const a=new FileReader;a.readAsDataURL(this.file_imagen),a.onloadend=()=>this.imagen_previsualiza=a.result,this.isLoadingView()}processFileTwo(e){if(!e.target.files||!e.target.files[0])return void this.toastr.error("Validaci\xf3n","No se seleccion\xf3 ninguna imagen");const n=e.target.files[0];if(!this.allowedImageTypes.includes(n.type.toLowerCase()))return this.toastr.error("Validaci\xf3n","Tipo de archivo no v\xe1lido. Solo se permiten im\xe1genes"),void(e.target.value="");this.imagen_add=n;const i=new FileReader;i.readAsDataURL(this.imagen_add),i.onloadend=()=>this.imagen_add_previsualiza=i.result,this.isLoadingView()}addImagen(){if(!this.imagen_add)return void this.toastr.error("Validaci\xf3n","Debe seleccionar una imagen");const e=new FormData;e.append("imagen_add",this.imagen_add),e.append("product_id",this.PRODUCT_ID),this.productService.imagenAdd(e).subscribe({next:n=>{this.images_files.unshift(n.imagen),this.imagen_add=null,this.imagen_add_previsualiza="https://preview.keenthemes.com/metronic8/demo1/assets/media/svg/illustrations/easy/2.svg",this.toastr.success("\xc9xito","Imagen agregada correctamente")},error:n=>{console.error("Error al agregar imagen:",n),this.toastr.error("Error","No se pudo agregar la imagen")}})}removeImages(e){const n=this.modalService.open(st,{centered:!0,size:"md"});n.componentInstance.id=e,n.componentInstance.ImagenD.subscribe(()=>{const i=this.images_files.findIndex(a=>a.id===e);-1!==i&&this.images_files.splice(i,1)})}isLoadingView(){this.productService.isLoadingSubject.next(!0),setTimeout(()=>{this.productService.isLoadingSubject.next(!1)},50)}onChange(e){this.description=e.editor.getData()}onItemSelect(e){console.log(e)}onSelectAll(e){console.log(e)}validateEmail(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}validatePhone(e){return/^[+]?[0-9\s\-\(\)]{7,15}$/.test(e)}deleteProduct(){confirm("\xbfEst\xe1s seguro de que deseas eliminar este anuncio? Esta acci\xf3n no se puede deshacer.")&&this.productService.deleteProduct(this.PRODUCT_ID).subscribe({next:e=>{console.log("Anuncio eliminado:",e),this.toastr.success("\xc9xito","Anuncio eliminado correctamente"),window.history.back()},error:e=>{console.error("Error al eliminar anuncio:",e),this.toastr.error("Error","No se pudo eliminar el anuncio")}})}save(){if(console.log("Verificando campos del formulario..."),!this.title||!this.categorie_first_id||!this.description)return void this.toastr.error("Validaci\xf3n","Los campos con * son obligatorios: T\xedtulo, Categor\xeda y Descripci\xf3n");if(this.contact_email&&!this.validateEmail(this.contact_email))return void this.toastr.error("Validaci\xf3n","El formato del email de contacto no es v\xe1lido");if(this.contact_phone&&!this.validatePhone(this.contact_phone))return void this.toastr.error("Validaci\xf3n","El formato del tel\xe9fono no es v\xe1lido (7-15 d\xedgitos)");if(this.price_pen&&this.price_pen<=0)return void this.toastr.error("Validaci\xf3n","El precio debe ser mayor a 0");console.log("Todos los campos son v\xe1lidos. Preparando FormData...");const e=new FormData;e.append("title",this.title),e.append("sku",this.sku),e.append("description",this.description),e.append("categorie_first_id",this.categorie_first_id),e.append("state",this.state.toString()),this.price_pen&&this.price_pen>0&&e.append("price_pen",this.price_pen.toString()),this.location&&e.append("location",this.location),this.contact_phone&&e.append("contact_phone",this.contact_phone),this.contact_email&&e.append("contact_email",this.contact_email),this.expires_at&&e.append("expires_at",this.expires_at),this.file_imagen&&e.append("portada",this.file_imagen),this.selectedItems&&this.selectedItems.length>0&&e.append("tags",JSON.stringify(this.selectedItems)),console.log("FormData preparado. Enviando solicitud para actualizar anuncio..."),this.productService.updateProducts(this.PRODUCT_ID,e).subscribe({next:n=>{console.log("Respuesta del servidor:",n),403==n.message?this.toastr.error("Error de permisos",n.message_text):500==n.message?this.toastr.error("Error del servidor",n.message_text):400==n.message?this.toastr.error("Error de validaci\xf3n",n.message_text):(this.file_imagen=null,this.toastr.success("\xc9xito","El anuncio se actualiz\xf3 correctamente"),console.log("Anuncio actualizado exitosamente"),setTimeout(()=>{this.router.navigate(["/products/list"])},1500))},error:n=>{console.error("Error al actualizar anuncio:",n),403===n.status?this.toastr.error("Error de permisos","No tienes permiso para editar este anuncio"):this.toastr.error("Error",n.error&&n.error.message_text?n.error.message_text:"Ha ocurrido un error al actualizar el anuncio")}})}getStateText(e){switch(e){case 1:return"Activo";case 0:return"Inactivo";case 2:return"Pausado";default:return"Desconocido"}}getStateDays(){if(!this.PRODUCT_SELECTED?.created_at)return 0;const e=new Date(this.PRODUCT_SELECTED.created_at),i=Math.abs((new Date).getTime()-e.getTime());return Math.ceil(i/864e5)}formatDate(e){return e?new Date(e).toLocaleDateString("es-PE",{year:"numeric",month:"long",day:"numeric"}):""}static \u0275fac=function(n){return new(n||o)(t.rXU(b.b),t.rXU(f.tw),t.rXU(_.nX),t.rXU(_.Ix),t.rXU(p.Bq))};static \u0275cmp=t.VBU({type:o,selectors:[["app-edit-product"]],decls:263,vars:35,consts:[[1,"container-fluid","py-4"],[1,"row","justify-content-center"],[1,"col-12","col-xl-10"],[1,"card","border-0","shadow-sm","mb-4"],[1,"card-header","bg-gradient-warning","border-0","py-4"],[1,"d-flex","align-items-center"],[1,"flex-shrink-0"],[1,"symbol","symbol-50px"],[1,"symbol-label","bg-white","bg-opacity-20"],[1,"fas","fa-edit","text-white","fs-2x"],[1,"flex-grow-1","ms-4"],[1,"text-white","mb-1","fs-2","fw-bold"],[1,"text-white-50","mb-0","fs-6"],[1,"badge","badge-light","fs-6"],[1,"fas","fa-hashtag","me-1"],["class","spinner-border text-white ms-3","role","status",4,"ngIf"],["novalidate","",1,"needs-validation"],[1,"card-header","bg-light","py-3"],[1,"badge","badge-circle","badge-primary","me-3","fs-6"],[1,"mb-0","text-gray-800"],[1,"text-muted"],[1,"card-body","p-6"],[1,"row","g-4"],[1,"col-12","col-lg-8"],[1,"form-floating"],["type","text","id","title","name","title","placeholder","T\xedtulo de tu anuncio","required","",1,"form-control",3,"ngModel","ngModelChange"],["for","title"],[1,"text-danger"],[1,"form-text","text-muted"],[1,"fas","fa-lightbulb","text-warning","me-1"],[1,"col-12","col-lg-4"],["type","text","id","sku","name","sku","placeholder","SKU","readonly","",1,"form-control","bg-light",3,"ngModel","ngModelChange"],["for","sku"],[1,"fas","fa-lock","text-secondary","me-1"],[1,"col-12"],["id","categoria","name","categoria","required","",1,"form-select",3,"ngModel","ngModelChange"],["value",""],[4,"ngFor","ngForOf"],["for","categoria"],[1,"fas","fa-tag","text-success","me-1"],[1,"badge","badge-circle","badge-success","me-3","fs-6"],[1,"col-12","col-md-6"],[1,"input-group"],[1,"input-group-text","bg-light-success","border-success"],[1,"fas","fa-dollar-sign","text-success"],[1,"form-floating","flex-grow-1"],["type","number","id","price","name","price_pen","placeholder","0.00","min","0","step","0.01",1,"form-control","border-success",3,"ngModel","ngModelChange"],["for","price"],["type","text","id","location","name","location","placeholder","Tingo Mar\xeda",1,"form-control",3,"ngModel","ngModelChange"],["for","location"],[1,"badge","badge-circle","badge-info","me-3","fs-6"],["type","tel","id","phone","name","contact_phone","placeholder","Tel\xe9fono",1,"form-control",3,"ngModel","ngModelChange"],["for","phone"],["type","email","id","email","name","contact_email","placeholder","Email",1,"form-control",3,"ngModel","ngModelChange"],["for","email"],[1,"badge","badge-circle","badge-secondary","me-3","fs-6"],[1,"row","g-4","mb-4"],[1,"col-6","col-md-3"],[1,"stat-item","bg-light-primary","rounded","p-4"],[1,"stat-number","text-primary"],[1,"stat-label"],[1,"stat-item","bg-light-success","rounded","p-4"],[1,"stat-number","text-success"],[1,"stat-item","bg-light-info","rounded","p-4"],[1,"stat-number","text-info"],[1,"stat-item","bg-light-warning","rounded","p-4"],[1,"stat-number","text-warning"],["id","state","name","state",1,"form-select",3,"ngModel","ngModelChange"],[3,"value"],["for","state"],["class","col-12 col-md-6",4,"ngIf"],[1,"badge","badge-circle","badge-warning","me-3","fs-6"],[1,"row","g-4","align-items-center"],[1,"border","border-dashed","border-warning","rounded","p-4","text-center"],["type","file","id","image-upload","accept","image/jpeg,image/jpg,image/png,image/gif,image/bmp,image/webp",1,"form-control","d-none",3,"change"],["for","image-upload",1,"btn","btn-light-warning","btn-lg","mb-3","cursor-pointer"],[1,"fas","fa-cloud-upload-alt","me-2"],[1,"text-warning"],[1,"text-center"],[1,"position-relative","d-inline-block"],["alt","Vista previa",1,"img-fluid","rounded","shadow-sm","border",2,"max-width","100%","max-height","200px","object-fit","cover",3,"src"],["class","position-absolute top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center bg-dark bg-opacity-25 rounded",4,"ngIf"],["id","description","name","description","placeholder","Descripci\xf3n","required","",1,"form-control",2,"min-height","150px",3,"ngModel","ngModelChange"],["for","description"],[1,"d-flex","align-items-start"],[1,"fas","fa-info-circle","text-primary","me-2","mt-1"],[1,"d-flex","align-items-center","justify-content-between"],[1,"badge","badge-circle","badge-light","me-3","fs-6"],[1,"input-group","mb-3"],["type","text","name","word","placeholder","Agregar etiqueta personalizada",1,"form-control",3,"ngModel","ngModelChange"],["type","button",1,"btn","btn-outline-primary",3,"click"],[1,"fas","fa-plus"],[4,"ngIf"],[1,"mt-4"],[1,"d-flex","flex-column","flex-md-row","gap-3","justify-content-end"],["type","button","onclick","history.back()",1,"btn","btn-light-secondary","btn-lg","flex-fill","flex-md-grow-0"],[1,"fas","fa-arrow-left","me-2"],["type","button",1,"btn","btn-danger","btn-lg","flex-fill","flex-md-grow-0",3,"click"],[1,"fas","fa-trash-alt","me-2"],["type","button",1,"btn","btn-warning","btn-lg","flex-fill","flex-md-grow-0",3,"disabled","click"],[1,"fas","fa-save","me-2"],["role","status",1,"spinner-border","text-white","ms-3"],[1,"visually-hidden"],["type","text","id","expires","readonly","",1,"form-control","bg-light",3,"value"],["for","expires"],[1,"position-absolute","top-0","start-0","w-100","h-100","d-flex","align-items-center","justify-content-center","bg-dark","bg-opacity-25","rounded"],[1,"text-white","text-center"],[1,"fw-bold"],[1,"dropdown-up",3,"placeholder","settings","data","ngModel","ngModelChange","onSelect","onSelectAll"]],template:function(n,i){1&n&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8),t.nrm(9,"i",9),t.k0s()()(),t.j41(10,"div",10)(11,"h1",11),t.EFF(12,"Editar Anuncio"),t.k0s(),t.j41(13,"p",12),t.EFF(14,"Modifica la informaci\xf3n de tu anuncio"),t.k0s()(),t.j41(15,"div",6)(16,"span",13),t.nrm(17,"i",14),t.EFF(18),t.k0s(),t.DNE(19,ct,3,0,"div",15),t.nI1(20,"async"),t.k0s()()()(),t.j41(21,"form",16)(22,"div",3)(23,"div",17)(24,"div",5)(25,"span",18),t.EFF(26,"1"),t.k0s(),t.j41(27,"div")(28,"h5",19),t.EFF(29,"Informaci\xf3n B\xe1sica"),t.k0s(),t.j41(30,"small",20),t.EFF(31,"T\xedtulo y categor\xeda de tu anuncio"),t.k0s()()()(),t.j41(32,"div",21)(33,"div",22)(34,"div",23)(35,"div",24)(36,"input",25),t.bIt("ngModelChange",function(r){return i.title=r}),t.k0s(),t.j41(37,"label",26),t.EFF(38,"T\xedtulo del anuncio "),t.j41(39,"span",27),t.EFF(40,"*"),t.k0s()()(),t.j41(41,"div",28),t.nrm(42,"i",29),t.EFF(43,' S\xe9 espec\xedfico y atractivo (ej: "iPhone 12 Pro Max 256GB como nuevo") '),t.k0s()(),t.j41(44,"div",30)(45,"div",24)(46,"input",31),t.bIt("ngModelChange",function(r){return i.sku=r}),t.k0s(),t.j41(47,"label",32),t.EFF(48,"C\xf3digo SKU (autom\xe1tico)"),t.k0s()(),t.j41(49,"div",28),t.nrm(50,"i",33),t.EFF(51," Generado autom\xe1ticamente del t\xedtulo "),t.k0s()(),t.j41(52,"div",34)(53,"div",24)(54,"select",35),t.bIt("ngModelChange",function(r){return i.categorie_first_id=r}),t.j41(55,"option",36),t.EFF(56,"Selecciona una categor\xeda"),t.k0s(),t.DNE(57,dt,3,2,"ng-container",37),t.k0s(),t.j41(58,"label",38),t.EFF(59,"Categor\xeda "),t.j41(60,"span",27),t.EFF(61,"*"),t.k0s()()(),t.j41(62,"div",28),t.nrm(63,"i",39),t.EFF(64," Elige la categor\xeda que mejor describa tu producto "),t.k0s()()()()(),t.j41(65,"div",3)(66,"div",17)(67,"div",5)(68,"span",40),t.EFF(69,"2"),t.k0s(),t.j41(70,"div")(71,"h5",19),t.EFF(72,"Precio y Ubicaci\xf3n"),t.k0s(),t.j41(73,"small",20),t.EFF(74,"Informaci\xf3n comercial (opcional)"),t.k0s()()()(),t.j41(75,"div",21)(76,"div",22)(77,"div",41)(78,"div",42)(79,"span",43),t.nrm(80,"i",44),t.k0s(),t.j41(81,"div",45)(82,"input",46),t.bIt("ngModelChange",function(r){return i.price_pen=r}),t.k0s(),t.j41(83,"label",47),t.EFF(84,"Precio en Soles (PEN)"),t.k0s()()(),t.j41(85,"div",28),t.EFF(86,' Deja vac\xedo si prefieres "Precio a consultar" '),t.k0s()(),t.j41(87,"div",41)(88,"div",24)(89,"input",48),t.bIt("ngModelChange",function(r){return i.location=r}),t.k0s(),t.j41(90,"label",49),t.EFF(91,"Ubicaci\xf3n"),t.k0s()(),t.j41(92,"div",28),t.EFF(93," Ciudad, distrito (ej: Tingo Mar\xeda, Rupa Rupa) "),t.k0s()()()()(),t.j41(94,"div",3)(95,"div",17)(96,"div",5)(97,"span",50),t.EFF(98,"3"),t.k0s(),t.j41(99,"div")(100,"h5",19),t.EFF(101,"Informaci\xf3n de Contacto"),t.k0s(),t.j41(102,"small",20),t.EFF(103,"Datos para que te contacten (opcional)"),t.k0s()()()(),t.j41(104,"div",21)(105,"div",22)(106,"div",41)(107,"div",24)(108,"input",51),t.bIt("ngModelChange",function(r){return i.contact_phone=r}),t.k0s(),t.j41(109,"label",52),t.EFF(110,"Tel\xe9fono"),t.k0s()(),t.j41(111,"div",28),t.EFF(112," Incluye c\xf3digo de pa\xeds (+51 999 888 777) "),t.k0s()(),t.j41(113,"div",41)(114,"div",24)(115,"input",53),t.bIt("ngModelChange",function(r){return i.contact_email=r}),t.k0s(),t.j41(116,"label",54),t.EFF(117,"Email de contacto"),t.k0s()(),t.j41(118,"div",28),t.EFF(119," Email alternativo para contacto directo "),t.k0s()()()()(),t.j41(120,"div",3)(121,"div",17)(122,"div",5)(123,"span",55),t.EFF(124,"4"),t.k0s(),t.j41(125,"div")(126,"h5",19),t.EFF(127,"Estado y Estad\xedsticas"),t.k0s(),t.j41(128,"small",20),t.EFF(129,"Informaci\xf3n del sistema y m\xe9tricas del anuncio"),t.k0s()()()(),t.j41(130,"div",21)(131,"div",56)(132,"div",57)(133,"div",58)(134,"div",59),t.EFF(135),t.k0s(),t.j41(136,"div",60),t.EFF(137,"ID del Anuncio"),t.k0s()()(),t.j41(138,"div",57)(139,"div",61)(140,"div",62),t.EFF(141),t.k0s(),t.j41(142,"div",60),t.EFF(143,"Vistas"),t.k0s()()(),t.j41(144,"div",57)(145,"div",63)(146,"div",64),t.EFF(147),t.k0s(),t.j41(148,"div",60),t.EFF(149,"D\xedas Publicado"),t.k0s()()(),t.j41(150,"div",57)(151,"div",65)(152,"div",66),t.EFF(153),t.k0s(),t.j41(154,"div",60),t.EFF(155,"Estado"),t.k0s()()()(),t.j41(156,"div",22)(157,"div",41)(158,"div",24)(159,"select",67),t.bIt("ngModelChange",function(r){return i.state=r}),t.j41(160,"option",68),t.EFF(161,"Activo"),t.k0s(),t.j41(162,"option",68),t.EFF(163,"Inactivo"),t.k0s(),t.j41(164,"option",68),t.EFF(165,"Pausado"),t.k0s()(),t.j41(166,"label",69),t.EFF(167,"Estado del anuncio"),t.k0s()(),t.j41(168,"div",28),t.EFF(169," Cambia el estado de publicaci\xf3n de tu anuncio "),t.k0s()(),t.DNE(170,lt,7,1,"div",70),t.k0s()()(),t.j41(171,"div",3)(172,"div",17)(173,"div",5)(174,"span",71),t.EFF(175,"5"),t.k0s(),t.j41(176,"div")(177,"h5",19),t.EFF(178,"Imagen Principal"),t.k0s(),t.j41(179,"small",20),t.EFF(180,"Actualiza la foto principal de tu anuncio"),t.k0s()()()(),t.j41(181,"div",21)(182,"div",72)(183,"div",41)(184,"div",73)(185,"input",74),t.bIt("change",function(r){return i.processFile(r)}),t.k0s(),t.j41(186,"label",75),t.nrm(187,"i",76),t.EFF(188," Cambiar Imagen "),t.k0s(),t.j41(189,"div",20)(190,"small")(191,"strong"),t.EFF(192,"Formatos:"),t.k0s(),t.EFF(193," JPG, PNG, GIF, WEBP"),t.nrm(194,"br"),t.j41(195,"strong"),t.EFF(196,"Tama\xf1o m\xe1ximo:"),t.k0s(),t.EFF(197," 5MB"),t.nrm(198,"br"),t.j41(199,"strong",77),t.EFF(200,"Opcional:"),t.k0s(),t.EFF(201," Dejar vac\xedo para mantener la actual "),t.k0s()()()(),t.j41(202,"div",41)(203,"div",78)(204,"div",79),t.nrm(205,"img",80),t.DNE(206,pt,4,0,"div",81),t.k0s()()()()()(),t.j41(207,"div",3)(208,"div",17)(209,"div",5)(210,"span",18),t.EFF(211,"6"),t.k0s(),t.j41(212,"div")(213,"h5",19),t.EFF(214,"Descripci\xf3n Detallada"),t.k0s(),t.j41(215,"small",20),t.EFF(216,"Describe tu producto de manera completa y atractiva"),t.k0s()()()(),t.j41(217,"div",21)(218,"div",24)(219,"textarea",82),t.bIt("ngModelChange",function(r){return i.description=r}),t.k0s(),t.j41(220,"label",83),t.EFF(221,"Descripci\xf3n del anuncio "),t.j41(222,"span",27),t.EFF(223,"*"),t.k0s()()(),t.j41(224,"div",28)(225,"div",84),t.nrm(226,"i",85),t.j41(227,"div")(228,"strong"),t.EFF(229,"Incluye:"),t.k0s(),t.EFF(230," Estado del producto, caracter\xedsticas principales, motivo de venta, condiciones de entrega. "),t.k0s()()()()(),t.j41(231,"div",3)(232,"div",17)(233,"div",86)(234,"div",5)(235,"span",87),t.EFF(236,"7"),t.k0s(),t.j41(237,"div")(238,"h5",19),t.EFF(239,"Etiquetas"),t.k0s(),t.j41(240,"small",20),t.EFF(241,"Palabras clave para mejorar b\xfasquedas (opcional)"),t.k0s()()()()(),t.j41(242,"div",21)(243,"div",88)(244,"input",89),t.bIt("ngModelChange",function(r){return i.word=r}),t.k0s(),t.j41(245,"button",90),t.bIt("click",function(){return i.addItems()}),t.nrm(246,"i",91),t.k0s()(),t.DNE(247,ut,2,4,"div",92),t.k0s()()(),t.j41(248,"div",93)(249,"div",94)(250,"button",95),t.nrm(251,"i",96),t.EFF(252," Cancelar "),t.k0s(),t.j41(253,"button",97),t.bIt("click",function(){return i.deleteProduct()}),t.nrm(254,"i",98),t.EFF(255," Eliminar Anuncio "),t.k0s(),t.j41(256,"button",99),t.bIt("click",function(){return i.save()}),t.nI1(257,"async"),t.nrm(258,"i",100),t.DNE(259,mt,2,0,"span",92),t.nI1(260,"async"),t.DNE(261,gt,2,0,"span",92),t.nI1(262,"async"),t.k0s()()()()()()),2&n&&(t.R7$(18),t.SpI(" ID: ",null==i.PRODUCT_SELECTED?null:i.PRODUCT_SELECTED.id," "),t.R7$(1),t.Y8G("ngIf",t.bMT(20,27,i.isLoading$)),t.R7$(17),t.Y8G("ngModel",i.title),t.R7$(10),t.Y8G("ngModel",i.sku),t.R7$(8),t.Y8G("ngModel",i.categorie_first_id),t.R7$(3),t.Y8G("ngForOf",i.categories_first),t.R7$(25),t.Y8G("ngModel",i.price_pen),t.R7$(7),t.Y8G("ngModel",i.location),t.R7$(19),t.Y8G("ngModel",i.contact_phone),t.R7$(7),t.Y8G("ngModel",i.contact_email),t.R7$(20),t.JRh((null==i.PRODUCT_SELECTED?null:i.PRODUCT_SELECTED.id)||0),t.R7$(6),t.JRh((null==i.PRODUCT_SELECTED?null:i.PRODUCT_SELECTED.views_count)||0),t.R7$(6),t.JRh(i.getStateDays()),t.R7$(6),t.JRh(i.getStateText(null==i.PRODUCT_SELECTED?null:i.PRODUCT_SELECTED.state)),t.R7$(6),t.Y8G("ngModel",i.state),t.R7$(1),t.Y8G("value",1),t.R7$(2),t.Y8G("value",0),t.R7$(2),t.Y8G("value",2),t.R7$(6),t.Y8G("ngIf",null==i.PRODUCT_SELECTED?null:i.PRODUCT_SELECTED.expires_at),t.R7$(35),t.Y8G("src",i.imagen_previsualiza,t.B4B),t.R7$(1),t.Y8G("ngIf",i.imagen_previsualiza),t.R7$(13),t.Y8G("ngModel",i.description),t.R7$(25),t.Y8G("ngModel",i.word),t.R7$(3),t.Y8G("ngIf",!i.isShowMultiselect&&i.selectedItems.length>0),t.R7$(9),t.Y8G("disabled",t.bMT(257,29,i.isLoading$)),t.R7$(3),t.Y8G("ngIf",!t.bMT(260,31,i.isLoading$)),t.R7$(2),t.Y8G("ngIf",t.bMT(262,33,i.isLoading$)))},dependencies:[d.Sq,d.bT,c.qT,c.xH,c.y7,c.me,c.Q0,c.wz,c.BC,c.cb,c.YS,c.VZ,c.vS,c.cV,h.b,d.Jj],styles:['@charset "UTF-8";.bg-gradient-warning[_ngcontent-%COMP%]{background:linear-gradient(135deg,#ffc107 0%,#e0a800 100%)}.bg-gradient-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#007bff 0%,#0056b3 100%)}.badge-circle[_ngcontent-%COMP%]{width:2.5rem;height:2.5rem;display:flex;align-items:center;justify-content:center;border-radius:50%;font-weight:600}.form-floating[_ngcontent-%COMP%]{position:relative}.form-floating[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%]:focus, .form-floating[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%]:not(:placeholder-shown){padding-top:1.625rem;padding-bottom:.625rem}.form-floating[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;padding:1rem .75rem;overflow:hidden;text-align:start;text-overflow:ellipsis;white-space:nowrap;pointer-events:none;border:1px solid transparent;transform-origin:0 0;transition:opacity .1s ease-in-out,transform .1s ease-in-out;color:#6c757d}.form-floating[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%]:focus ~ label[_ngcontent-%COMP%], .form-floating[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%]:not(:placeholder-shown) ~ label[_ngcontent-%COMP%]{opacity:.65;transform:scale(.85) translateY(-.5rem) translate(.15rem);color:#007bff}.form-floating[_ngcontent-%COMP%] > .form-select[_ngcontent-%COMP%]:focus ~ label[_ngcontent-%COMP%], .form-floating[_ngcontent-%COMP%] > .form-select[_ngcontent-%COMP%]:not([value=""]) ~ label[_ngcontent-%COMP%]{opacity:.65;transform:scale(.85) translateY(-.5rem) translate(.15rem);color:#007bff}.card[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 .5rem 1rem #0000001a!important}.form-control[_ngcontent-%COMP%]:focus{border-color:#007bff;box-shadow:0 0 0 .2rem #007bff40}.form-select[_ngcontent-%COMP%]:focus{border-color:#007bff;box-shadow:0 0 0 .2rem #007bff40}.btn-light-primary[_ngcontent-%COMP%]:hover{background-color:#007bff;border-color:#007bff;color:#fff}.cursor-pointer[_ngcontent-%COMP%]{cursor:pointer}.border-dashed[_ngcontent-%COMP%]{border-style:dashed!important}@media (max-width: 768px){.card-header[_ngcontent-%COMP%], .card-body[_ngcontent-%COMP%]{padding:1rem!important}.badge-circle[_ngcontent-%COMP%]{width:2rem;height:2rem;font-size:.875rem}}.form-control[_ngcontent-%COMP%], .form-select[_ngcontent-%COMP%], .btn[_ngcontent-%COMP%]{transition:all .15s ease-in-out}.image-upload-area[_ngcontent-%COMP%]{transition:all .3s ease}.image-upload-area[_ngcontent-%COMP%]:hover{background-color:#007bff0d;border-color:#007bff!important}.badge-circle.badge-primary[_ngcontent-%COMP%]{background-color:#007bff;color:#fff}.badge-circle.badge-success[_ngcontent-%COMP%]{background-color:#28a745;color:#fff}.badge-circle.badge-info[_ngcontent-%COMP%]{background-color:#17a2b8;color:#fff}.badge-circle.badge-warning[_ngcontent-%COMP%]{background-color:#ffc107;color:#212529}.badge-circle.badge-secondary[_ngcontent-%COMP%]{background-color:#6c757d;color:#fff}.badge-circle.badge-light[_ngcontent-%COMP%]{background-color:#f8f9fa;color:#6c757d;border:2px solid #dee2e6}.dropdown-container[_ngcontent-%COMP%]{min-height:60px!important;position:relative!important;margin-bottom:1rem!important}.dropdown-wrapper[_ngcontent-%COMP%]{position:relative!important;z-index:1000!important}[_nghost-%COMP%]     .ng-multiselect-dropdown{position:relative!important}[_nghost-%COMP%]     .ng-multiselect-dropdown .dropdown-list{z-index:10000!important;position:absolute!important;inset:auto 0 100%!important;max-height:200px!important;overflow-y:auto!important;background:white!important;border:1px solid #dee2e6!important;border-radius:.375rem!important;box-shadow:0 -.5rem 1rem #00000026!important;margin-bottom:.5rem!important;transform:translateY(-2px)!important}[_nghost-%COMP%]     .ng-multiselect-dropdown .dropdown-btn{border:1px solid #ced4da!important;border-radius:.375rem!important;padding:.75rem!important;background:white!important;width:100%!important;min-height:48px!important}[_nghost-%COMP%]     .ng-multiselect-dropdown .dropdown-btn:focus{border-color:#ffc107!important;box-shadow:0 0 0 .2rem #ffc10740!important}[_nghost-%COMP%]     .ng-multiselect-dropdown .dropdown-btn:hover{border-color:#ffc107!important}.container-fluid[_ngcontent-%COMP%]{padding:2rem 0;margin-top:3rem!important}.container-fluid[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{border:none!important;box-shadow:0 .5rem 1.5rem #0000001a!important}.dropdown-container[_ngcontent-%COMP%]{margin-bottom:2rem!important}.btn[_ngcontent-%COMP%]{white-space:nowrap!important}.btn[_ngcontent-%COMP%]   .fas[_ngcontent-%COMP%], .btn[_ngcontent-%COMP%]   .fa[_ngcontent-%COMP%]{margin-right:.5rem!important}.btn-light-secondary[_ngcontent-%COMP%]{background-color:#f8f9fa!important;border-color:#f8f9fa!important;color:#6c757d!important}.btn-light-secondary[_ngcontent-%COMP%]:hover{background-color:#e9ecef!important;border-color:#e9ecef!important;color:#495057!important}.stat-item[_ngcontent-%COMP%]{text-align:center;transition:all .2s ease-in-out}.stat-item[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.stat-item[_ngcontent-%COMP%]   .stat-number[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;line-height:1.2}.stat-item[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{font-size:.875rem;color:#6c757d;font-weight:500}.product-stats[_ngcontent-%COMP%]{background:linear-gradient(45deg,#f8f9fa,#e9ecef);border-radius:.5rem;border:1px solid #dee2e6}.stat-item[_ngcontent-%COMP%]{text-align:center;padding:1rem}.stat-number[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;margin-bottom:.25rem}.stat-label[_ngcontent-%COMP%]{font-size:.875rem;color:#6c757d}']})}return o})();var u=l(1626),ft=l(4412),m=l(980),g=l(7583),ht=l(4367);let v=(()=>{class o{http;authservice;isLoading$;isLoadingSubject;constructor(e,n){this.http=e,this.authservice=n,this.isLoadingSubject=new ft.t(!1),this.isLoading$=this.isLoadingSubject.asObservable()}configAll(){this.isLoadingSubject.next(!0);let e=new u.Lr({Authorization:"Bearer "+this.authservice.token});return this.http.get(g.qA+"/admin/variations/config",{headers:e}).pipe((0,m.j)(()=>this.isLoadingSubject.next(!1)))}showProduct(e){this.isLoadingSubject.next(!0);let n=new u.Lr({Authorization:"Bearer "+this.authservice.token});return this.http.get(g.qA+"/admin/products/"+e,{headers:n}).pipe((0,m.j)(()=>this.isLoadingSubject.next(!1)))}listSpecification(e){this.isLoadingSubject.next(!0);let n=new u.Lr({Authorization:"Bearer "+this.authservice.token});return this.http.get(g.qA+"/admin/specifications?product_id="+e,{headers:n}).pipe((0,m.j)(()=>this.isLoadingSubject.next(!1)))}createSpecification(e){this.isLoadingSubject.next(!0);let n=new u.Lr({Authorization:"Bearer "+this.authservice.token});return this.http.post(g.qA+"/admin/specifications",e,{headers:n}).pipe((0,m.j)(()=>this.isLoadingSubject.next(!1)))}updateSpecification(e,n){this.isLoadingSubject.next(!0);let i=new u.Lr({Authorization:"Bearer "+this.authservice.token});return this.http.put(g.qA+"/admin/specifications/"+e,n,{headers:i}).pipe((0,m.j)(()=>this.isLoadingSubject.next(!1)))}deleteSpecification(e){this.isLoadingSubject.next(!0);let n=new u.Lr({Authorization:"Bearer "+this.authservice.token});return this.http.delete(g.qA+"/admin/specifications/"+e,{headers:n}).pipe((0,m.j)(()=>this.isLoadingSubject.next(!1)))}listVariations(e){this.isLoadingSubject.next(!0);let n=new u.Lr({Authorization:"Bearer "+this.authservice.token});return this.http.get(g.qA+"/admin/variations?product_id="+e,{headers:n}).pipe((0,m.j)(()=>this.isLoadingSubject.next(!1)))}createVariations(e){this.isLoadingSubject.next(!0);let n=new u.Lr({Authorization:"Bearer "+this.authservice.token});return this.http.post(g.qA+"/admin/variations",e,{headers:n}).pipe((0,m.j)(()=>this.isLoadingSubject.next(!1)))}updateVariations(e,n){this.isLoadingSubject.next(!0);let i=new u.Lr({Authorization:"Bearer "+this.authservice.token});return this.http.put(g.qA+"/admin/variations/"+e,n,{headers:i}).pipe((0,m.j)(()=>this.isLoadingSubject.next(!1)))}deleteVariations(e){this.isLoadingSubject.next(!0);let n=new u.Lr({Authorization:"Bearer "+this.authservice.token});return this.http.delete(g.qA+"/admin/variations/"+e,{headers:n}).pipe((0,m.j)(()=>this.isLoadingSubject.next(!1)))}listVariationsAnidadas(e,n){this.isLoadingSubject.next(!0);let i=new u.Lr({Authorization:"Bearer "+this.authservice.token});return this.http.get(g.qA+"/admin/anidado_variations?product_id="+e+"&product_variation_id="+n,{headers:i}).pipe((0,m.j)(()=>this.isLoadingSubject.next(!1)))}createVariationsAnidadas(e){this.isLoadingSubject.next(!0);let n=new u.Lr({Authorization:"Bearer "+this.authservice.token});return this.http.post(g.qA+"/admin/anidado_variations",e,{headers:n}).pipe((0,m.j)(()=>this.isLoadingSubject.next(!1)))}updateVariationsAnidadas(e,n){this.isLoadingSubject.next(!0);let i=new u.Lr({Authorization:"Bearer "+this.authservice.token});return this.http.put(g.qA+"/admin/anidado_variations/"+e,n,{headers:i}).pipe((0,m.j)(()=>this.isLoadingSubject.next(!1)))}deleteVariationsAnidadas(e){this.isLoadingSubject.next(!0);let n=new u.Lr({Authorization:"Bearer "+this.authservice.token});return this.http.delete(g.qA+"/admin/anidado_variations/"+e,{headers:n}).pipe((0,m.j)(()=>this.isLoadingSubject.next(!1)))}static \u0275fac=function(n){return new(n||o)(t.KVO(u.Qq),t.KVO(ht.uR))};static \u0275prov=t.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();function bt(o,s){if(1&o&&(t.qex(0),t.j41(1,"option",25),t.EFF(2),t.k0s(),t.bVm()),2&o){const e=s.$implicit;t.R7$(1),t.Y8G("value",e.id),t.R7$(1),t.JRh(e.name)}}function vt(o,s){if(1&o){const e=t.RV6();t.j41(0,"div",14)(1,"label",15),t.EFF(2,"Atributos E.:(*)"),t.k0s(),t.j41(3,"select",22),t.bIt("ngModelChange",function(i){t.eBV(e);const a=t.XpG();return t.Njj(a.specification_attribute_id=i)})("change",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.changeSpecifications())}),t.j41(4,"option",23),t.EFF(5,"Selec."),t.k0s(),t.DNE(6,bt,3,2,"ng-container",24),t.k0s()()}if(2&o){const e=t.XpG();t.R7$(3),t.Y8G("ngModel",e.specification_attribute_id),t.R7$(3),t.Y8G("ngForOf",e.attributes_specifications)}}function Ct(o,s){if(1&o&&(t.qex(0),t.j41(1,"option",25),t.EFF(2),t.k0s(),t.bVm()),2&o){const e=s.$implicit;t.R7$(1),t.Y8G("value",e.id),t.R7$(1),t.JRh(e.name)}}function Et(o,s){if(1&o){const e=t.RV6();t.j41(0,"div",14)(1,"label",15),t.EFF(2),t.k0s(),t.j41(3,"select",26),t.bIt("ngModelChange",function(i){t.eBV(e);const a=t.XpG();return t.Njj(a.variations_attribute_id=i)})("change",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.changeVariations())}),t.j41(4,"option",23),t.EFF(5,"Selec."),t.k0s(),t.DNE(6,Ct,3,2,"ng-container",24),t.k0s()()}if(2&o){const e=t.XpG();t.R7$(2),t.SpI("Atributos V.:(*) ",e.variations_attribute_id,""),t.R7$(1),t.Y8G("ngModel",e.variations_attribute_id),t.R7$(3),t.Y8G("ngForOf",e.attributes_variations)}}function kt(o,s){if(1&o){const e=t.RV6();t.qex(0),t.j41(1,"input",27),t.bIt("ngModelChange",function(i){t.eBV(e);const a=t.XpG();return t.Njj(a.value_add=i)}),t.k0s(),t.bVm()}if(2&o){const e=t.XpG();t.R7$(1),t.Y8G("ngModel",e.value_add)}}function Ft(o,s){if(1&o){const e=t.RV6();t.qex(0),t.j41(1,"input",28),t.bIt("ngModelChange",function(i){t.eBV(e);const a=t.XpG();return t.Njj(a.value_add=i)}),t.k0s(),t.bVm()}if(2&o){const e=t.XpG();t.R7$(1),t.Y8G("ngModel",e.value_add)}}function jt(o,s){if(1&o&&(t.qex(0),t.j41(1,"option",25),t.EFF(2),t.k0s(),t.bVm()),2&o){const e=s.$implicit;t.R7$(1),t.Y8G("value",e.id),t.R7$(1),t.JRh(e.name)}}function xt(o,s){if(1&o){const e=t.RV6();t.qex(0),t.j41(1,"select",29),t.bIt("ngModelChange",function(i){t.eBV(e);const a=t.XpG();return t.Njj(a.propertie_id=i)}),t.j41(2,"option",23),t.EFF(3,"Selec."),t.k0s(),t.DNE(4,jt,3,2,"ng-container",24),t.k0s(),t.bVm()}if(2&o){const e=t.XpG();t.R7$(1),t.Y8G("ngModel",e.propertie_id),t.R7$(3),t.Y8G("ngForOf",e.properties)}}const wt=function(){return{standalone:!0}};function yt(o,s){if(1&o){const e=t.RV6();t.qex(0),t.j41(1,"ng-multiselect-dropdown",30),t.bIt("ngModelChange",function(i){t.eBV(e);const a=t.XpG();return t.Njj(a.selectedItems=i)})("onSelect",function(i){t.eBV(e);const a=t.XpG();return t.Njj(a.onItemSelect(i))})("onSelectAll",function(i){t.eBV(e);const a=t.XpG();return t.Njj(a.onSelectAll(i))}),t.k0s(),t.bVm()}if(2&o){const e=t.XpG();t.R7$(1),t.Y8G("placeholder","custom placeholder")("settings",e.dropdownSettings)("data",e.dropdownList)("ngModelOptions",t.lJ4(5,wt))("ngModel",e.selectedItems)}}function Mt(o,s){if(1&o){const e=t.RV6();t.j41(0,"div",14)(1,"label",15),t.EFF(2,"Agregar Precio:(Opcional)"),t.k0s(),t.j41(3,"input",31),t.bIt("ngModelChange",function(i){t.eBV(e);const a=t.XpG();return t.Njj(a.precio_add=i)}),t.k0s()()}if(2&o){const e=t.XpG();t.R7$(3),t.Y8G("ngModel",e.precio_add)}}function St(o,s){if(1&o){const e=t.RV6();t.j41(0,"div",14)(1,"label",15),t.EFF(2,"Agregar Stock:(*)"),t.k0s(),t.j41(3,"input",32),t.bIt("ngModelChange",function(i){t.eBV(e);const a=t.XpG();return t.Njj(a.stock_add=i)}),t.k0s()()}if(2&o){const e=t.XpG();t.R7$(3),t.Y8G("ngModel",e.stock_add)}}function It(o,s){1&o&&t.nrm(0,"span",33)}let x=(()=>{class o{attributeService;modal;toastr;EspecificationE=new t.bkB;specification;attributes_variations=[];is_variation;isLoading$;specification_attribute_id="";type_attribute_specification=2;variations_attribute_id="";type_attribute_variation=4;attributes=[];dropdownList=[];selectedItems=[];dropdownSettings={};attributes_specifications=[];properties=[];propertie_id=null;value_add=null;specifications=[];precio_add=0;stock_add=0;constructor(e,n,i){this.attributeService=e,this.modal=n,this.toastr=i}ngOnInit(){this.isLoading$=this.attributeService.isLoading$,this.dropdownSettings={singleSelection:!1,idField:"id",textField:"name",selectAllText:"Select All",unSelectAllText:"UnSelect All",allowSearchFilter:!0},this.is_variation?(this.variations_attribute_id=this.specification.attribute_id,console.log(this.variations_attribute_id),this.changeVariations()):(this.specification_attribute_id=this.specification.attribute_id,this.changeSpecifications()),setTimeout(()=>{let e=this.type_attribute_specification;this.propertie_id=this.specification.propertie_id?this.specification.propertie_id:null,4==this.specification.attribute.type_attribute?(this.type_attribute_specification=0,this.selectedItems=this.specification.value_add?JSON.parse(this.specification.value_add):[],setTimeout(()=>{this.type_attribute_specification=e,this.isLoadingView()},25)):this.value_add=this.specification.value_add?this.specification.value_add:null},25),this.is_variation&&(this.precio_add=this.specification.add_price,this.stock_add=this.specification.stock)}store(){this.is_variation?this.storeVariation():this.storeSpecification()}storeSpecification(){4!=this.type_attribute_specification||0!=this.selectedItems.length?(this.selectedItems.length>0&&(this.value_add=JSON.stringify(this.selectedItems)),this.specification_attribute_id&&(this.propertie_id||this.value_add)?this.attributeService.updateSpecification(this.specification.id,{product_id:this.specification.product_id,attribute_id:this.specification_attribute_id,propertie_id:this.propertie_id,value_add:this.value_add}).subscribe(n=>{console.log(n),403==n.message?this.toastr.error("Validaci\xf3n",n.message_text):(this.toastr.success("Exito","Se actualizo la especificaci\xf3n correctamente"),this.EspecificationE.emit(n),this.modal.close())}):this.toastr.error("Validaci\xf3n","Llene los campos necesarios")):this.toastr.error("Validaci\xf3n","Necesitas seleccionar algunos items")}storeVariation(){this.variations_attribute_id&&(this.propertie_id||this.value_add)?this.attributeService.updateVariations(this.specification.id,{product_id:this.specification.product_id,attribute_id:this.variations_attribute_id,propertie_id:this.propertie_id,value_add:this.value_add,add_price:this.precio_add,stock:this.stock_add}).subscribe(n=>{console.log(n),403==n.message?this.toastr.error("Validaci\xf3n",n.message_text):(this.toastr.success("Exito","Se actualizo la variaci\xf3n correctamente"),this.EspecificationE.emit(n),this.modal.close())}):this.toastr.error("Validaci\xf3n","Llene los campos necesarios")}onItemSelect(e){console.log(e)}onSelectAll(e){console.log(e)}isLoadingView(){this.attributeService.isLoadingSubject.next(!0),setTimeout(()=>{this.attributeService.isLoadingSubject.next(!1)},50)}changeSpecifications(){this.value_add=null,this.propertie_id=null,this.selectedItems=[];let e=this.attributes_specifications.find(n=>n.id==this.specification_attribute_id);e?(this.type_attribute_specification=e.type_attribute,3==this.type_attribute_specification||4==this.type_attribute_specification?(this.properties=e.properties,this.dropdownList=e.properties):(this.properties=[],this.dropdownList=[])):(this.type_attribute_specification=0,this.properties=[],this.dropdownList=[])}changeVariations(){this.value_add=null,this.propertie_id=null;let e=this.attributes_variations.find(n=>n.id==this.variations_attribute_id);e?(this.type_attribute_specification=e.type_attribute,this.properties=3==this.type_attribute_specification||4==this.type_attribute_specification?e.properties:[]):(this.type_attribute_specification=0,this.properties=[])}static \u0275fac=function(n){return new(n||o)(t.rXU(v),t.rXU(p.Lw),t.rXU(f.tw))};static \u0275cmp=t.VBU({type:o,selectors:[["app-edit-variation-specifications"]],inputs:{specification:"specification",attributes_variations:"attributes_variations",is_variation:"is_variation",attributes_specifications:"attributes_specifications"},outputs:{EspecificationE:"EspecificationE"},decls:33,vars:13,consts:[[1,"modal-content"],["id","kt_modal_add_user_header",1,"modal-header"],[1,"fw-bolder"],["data-kt-users-modal-action","close",1,"btn","btn-icon","btn-sm","btn-active-icon-primary",3,"click"],[1,"svg-icon","svg-icon-1"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none"],["opacity","0.5","x","6","y","17.3137","width","16","height","2","rx","1","transform","rotate(-45 6 17.3137)","fill","currentColor"],["x","7.41422","y","6","width","16","height","2","rx","1","transform","rotate(45 7.41422 6)","fill","currentColor"],[1,"modal-body","scroll-y","mx-5","my-7"],["id","kt_modal_add_user_form","action","#",1,"form"],[1,"row"],[1,"col-12"],[1,"row","align-items-center"],["class","col-6",4,"ngIf"],[1,"col-6"],[1,"fw-semibold","fs-6","py-2"],[4,"ngIf"],[1,"text-center","pt-15"],["type","reset",1,"btn","btn-light","me-3",3,"click"],["type","button","data-kt-users-modal-action","submit",1,"btn","btn-primary",3,"click"],[1,"indicator-label"],["class","spinner-border spinner-border-sm align-middle ms-2",4,"ngIf"],["name","specification_attribute_id","placeholder","Selec. Atributo",1,"form-control","form-select-solid","fw-bolder",3,"ngModel","ngModelChange","change"],["value",""],[4,"ngFor","ngForOf"],[3,"value"],["name","variations_attribute_id","placeholder","Selec. Atributo",1,"form-control","form-select-solid","fw-bolder",3,"ngModel","ngModelChange","change"],["type","text","name","value_add","placeholder","Por ejemplo:   The best note",1,"form-control","form-control-lg","form-control-solid",3,"ngModel","ngModelChange"],["type","number","name","value_add","placeholder","Por ejemplo:   34566",1,"form-control","form-control-lg","form-control-solid",3,"ngModel","ngModelChange"],["name","departament",1,"form-control","form-select-solid","fw-bolder",3,"ngModel","ngModelChange"],[3,"placeholder","settings","data","ngModelOptions","ngModel","ngModelChange","onSelect","onSelectAll"],["type","number","name","precio_add","placeholder","Por ejemplo:   15",1,"form-control","form-control-lg","form-control-solid",3,"ngModel","ngModelChange"],["type","number","name","stock_add","placeholder","Por ejemplo:   15",1,"form-control","form-control-lg","form-control-solid",3,"ngModel","ngModelChange"],[1,"spinner-border","spinner-border-sm","align-middle","ms-2"]],template:function(n,i){1&n&&(t.j41(0,"div",0)(1,"div",1)(2,"h2",2),t.EFF(3),t.k0s(),t.j41(4,"div",3),t.bIt("click",function(){return i.modal.dismiss()}),t.j41(5,"span",4),t.qSk(),t.j41(6,"svg",5),t.nrm(7,"rect",6)(8,"rect",7),t.k0s()()()(),t.joV(),t.j41(9,"div",8)(10,"form",9)(11,"div",10)(12,"div",11)(13,"div",12),t.DNE(14,vt,7,2,"div",13),t.DNE(15,Et,7,3,"div",13),t.j41(16,"div",14)(17,"label",15),t.EFF(18,"Campo: (*)"),t.k0s(),t.DNE(19,kt,2,1,"ng-container",16),t.DNE(20,Ft,2,1,"ng-container",16),t.DNE(21,xt,5,2,"ng-container",16),t.DNE(22,yt,2,6,"ng-container",16),t.k0s(),t.DNE(23,Mt,4,1,"div",13),t.DNE(24,St,4,1,"div",13),t.k0s()()(),t.j41(25,"div",17)(26,"button",18),t.bIt("click",function(){return i.modal.dismiss()}),t.EFF(27,"Cerrar"),t.k0s(),t.j41(28,"button",19),t.bIt("click",function(){return i.store()}),t.j41(29,"span",20),t.EFF(30,"Actualizar"),t.k0s(),t.DNE(31,It,1,0,"span",21),t.nI1(32,"async"),t.k0s()()()()()),2&n&&(t.R7$(3),t.Lme("Edit ",i.is_variation?"Variation":"Especification",' : "',i.specification.attribute.name,'"'),t.R7$(11),t.Y8G("ngIf",!i.is_variation),t.R7$(1),t.Y8G("ngIf",i.is_variation),t.R7$(4),t.Y8G("ngIf",1==i.type_attribute_specification),t.R7$(1),t.Y8G("ngIf",2==i.type_attribute_specification),t.R7$(1),t.Y8G("ngIf",3==i.type_attribute_specification),t.R7$(1),t.Y8G("ngIf",4==i.type_attribute_specification),t.R7$(1),t.Y8G("ngIf",i.is_variation),t.R7$(1),t.Y8G("ngIf",i.is_variation),t.R7$(7),t.Y8G("ngIf",t.bMT(32,11,i.isLoading$)))},dependencies:[d.Sq,d.bT,c.qT,c.xH,c.y7,c.me,c.Q0,c.wz,c.BC,c.cb,c.vS,c.cV,h.b,d.Jj]})}return o})();function Tt(o,s){1&o&&t.nrm(0,"span",15)}let k=(()=>{class o{attributeService;toastr;modal;specification;is_variation;EspecificationD=new t.bkB;isLoading;constructor(e,n,i){this.attributeService=e,this.toastr=n,this.modal=i}ngOnInit(){this.isLoading=this.attributeService.isLoading$}delete(){this.is_variation?this.deletevVariation():this.deleteSpecification()}deleteSpecification(){this.attributeService.deleteSpecification(this.specification.id).subscribe(e=>{this.EspecificationD.emit({message:200}),this.modal.close()})}deletevVariation(){this.attributeService.deleteVariations(this.specification.id).subscribe(e=>{this.EspecificationD.emit({message:200}),this.modal.close()})}static \u0275fac=function(n){return new(n||o)(t.rXU(v),t.rXU(f.tw),t.rXU(p.Lw))};static \u0275cmp=t.VBU({type:o,selectors:[["app-delete-variation-specifications"]],inputs:{specification:"specification",is_variation:"is_variation"},outputs:{EspecificationD:"EspecificationD"},decls:21,vars:6,consts:[[1,"modal-content"],["id","kt_modal_add_user_header",1,"modal-header"],[1,"fw-bolder"],["data-kt-users-modal-action","close",1,"btn","btn-icon","btn-sm","btn-active-icon-primary",3,"click"],[1,"svg-icon","svg-icon-1"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none"],["opacity","0.5","x","6","y","17.3137","width","16","height","2","rx","1","transform","rotate(-45 6 17.3137)","fill","currentColor"],["x","7.41422","y","6","width","16","height","2","rx","1","transform","rotate(45 7.41422 6)","fill","currentColor"],[1,"modal-body","scroll-y","mx-5","mx-xl-15","my-7"],["id","kt_modal_add_user_form","action","#",1,"form"],[1,"text-center","pt-15"],["type","reset",1,"btn","btn-light","me-3",3,"click"],["type","button","data-kt-users-modal-action","submit",1,"btn","btn-danger",3,"click"],[1,"indicator-label"],["class","spinner-border spinner-border-sm align-middle ms-2",4,"ngIf"],[1,"spinner-border","spinner-border-sm","align-middle","ms-2"]],template:function(n,i){1&n&&(t.j41(0,"div",0)(1,"div",1)(2,"h2",2),t.EFF(3),t.k0s(),t.j41(4,"div",3),t.bIt("click",function(){return i.modal.dismiss()}),t.j41(5,"span",4),t.qSk(),t.j41(6,"svg",5),t.nrm(7,"rect",6)(8,"rect",7),t.k0s()()()(),t.joV(),t.j41(9,"div",8)(10,"form",9)(11,"p"),t.EFF(12),t.k0s(),t.j41(13,"div",10)(14,"button",11),t.bIt("click",function(){return i.modal.dismiss()}),t.EFF(15,"Cerrar"),t.k0s(),t.j41(16,"button",12),t.bIt("click",function(){return i.delete()}),t.j41(17,"span",13),t.EFF(18,"ELIMINAR"),t.k0s(),t.DNE(19,Tt,1,0,"span",14),t.nI1(20,"async"),t.k0s()()()()()),2&n&&(t.R7$(3),t.Lme("Delete ",i.is_variation?"Variation":"Specification"," : #",i.specification.attribute.name,""),t.R7$(9),t.SpI(" \xbfESTAS SEGURO DE ELIMINAR ESTA ",i.is_variation?"VARIATION":"SPECIFICATION","? "),t.R7$(7),t.Y8G("ngIf",t.bMT(20,4,i.isLoading)))},dependencies:[d.bT,c.qT,c.cb,c.cV,d.Jj]})}return o})();function Pt(o,s){if(1&o&&(t.qex(0),t.j41(1,"option",25),t.EFF(2),t.k0s(),t.bVm()),2&o){const e=s.$implicit;t.R7$(1),t.Y8G("value",e.id),t.R7$(1),t.JRh(e.name)}}function Vt(o,s){if(1&o){const e=t.RV6();t.j41(0,"div",14)(1,"label",15),t.EFF(2,"Atributos E.:(*)"),t.k0s(),t.j41(3,"select",22),t.bIt("ngModelChange",function(i){t.eBV(e);const a=t.XpG();return t.Njj(a.specification_attribute_id=i)})("change",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.changeSpecifications())}),t.j41(4,"option",23),t.EFF(5,"Selec."),t.k0s(),t.DNE(6,Pt,3,2,"ng-container",24),t.k0s()()}if(2&o){const e=t.XpG();t.R7$(3),t.Y8G("ngModel",e.specification_attribute_id),t.R7$(3),t.Y8G("ngForOf",e.attributes_specifications)}}function Rt(o,s){if(1&o&&(t.qex(0),t.j41(1,"option",25),t.EFF(2),t.k0s(),t.bVm()),2&o){const e=s.$implicit;t.R7$(1),t.Y8G("value",e.id),t.R7$(1),t.JRh(e.name)}}function Dt(o,s){if(1&o){const e=t.RV6();t.j41(0,"div",14)(1,"label",15),t.EFF(2),t.k0s(),t.j41(3,"select",26),t.bIt("ngModelChange",function(i){t.eBV(e);const a=t.XpG();return t.Njj(a.variations_attribute_id=i)})("change",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.changeVariations())}),t.j41(4,"option",23),t.EFF(5,"Selec."),t.k0s(),t.DNE(6,Rt,3,2,"ng-container",24),t.k0s()()}if(2&o){const e=t.XpG();t.R7$(2),t.SpI("Atributos V.:(*) ",e.variations_attribute_id,""),t.R7$(1),t.Y8G("ngModel",e.variations_attribute_id),t.R7$(3),t.Y8G("ngForOf",e.attributes_variations)}}function $t(o,s){if(1&o){const e=t.RV6();t.qex(0),t.j41(1,"input",27),t.bIt("ngModelChange",function(i){t.eBV(e);const a=t.XpG();return t.Njj(a.value_add=i)}),t.k0s(),t.bVm()}if(2&o){const e=t.XpG();t.R7$(1),t.Y8G("ngModel",e.value_add)}}function Gt(o,s){if(1&o){const e=t.RV6();t.qex(0),t.j41(1,"input",28),t.bIt("ngModelChange",function(i){t.eBV(e);const a=t.XpG();return t.Njj(a.value_add=i)}),t.k0s(),t.bVm()}if(2&o){const e=t.XpG();t.R7$(1),t.Y8G("ngModel",e.value_add)}}function At(o,s){if(1&o&&(t.qex(0),t.j41(1,"option",25),t.EFF(2),t.k0s(),t.bVm()),2&o){const e=s.$implicit;t.R7$(1),t.Y8G("value",e.id),t.R7$(1),t.JRh(e.name)}}function Ot(o,s){if(1&o){const e=t.RV6();t.qex(0),t.j41(1,"select",29),t.bIt("ngModelChange",function(i){t.eBV(e);const a=t.XpG();return t.Njj(a.propertie_id=i)}),t.j41(2,"option",23),t.EFF(3,"Selec."),t.k0s(),t.DNE(4,At,3,2,"ng-container",24),t.k0s(),t.bVm()}if(2&o){const e=t.XpG();t.R7$(1),t.Y8G("ngModel",e.propertie_id),t.R7$(3),t.Y8G("ngForOf",e.properties)}}const Lt=function(){return{standalone:!0}};function Nt(o,s){if(1&o){const e=t.RV6();t.qex(0),t.j41(1,"ng-multiselect-dropdown",30),t.bIt("ngModelChange",function(i){t.eBV(e);const a=t.XpG();return t.Njj(a.selectedItems=i)})("onSelect",function(i){t.eBV(e);const a=t.XpG();return t.Njj(a.onItemSelect(i))})("onSelectAll",function(i){t.eBV(e);const a=t.XpG();return t.Njj(a.onSelectAll(i))}),t.k0s(),t.bVm()}if(2&o){const e=t.XpG();t.R7$(1),t.Y8G("placeholder","custom placeholder")("settings",e.dropdownSettings)("data",e.dropdownList)("ngModelOptions",t.lJ4(5,Lt))("ngModel",e.selectedItems)}}function Yt(o,s){if(1&o){const e=t.RV6();t.j41(0,"div",14)(1,"label",15),t.EFF(2,"Agregar Precio:(Opcional)"),t.k0s(),t.j41(3,"input",31),t.bIt("ngModelChange",function(i){t.eBV(e);const a=t.XpG();return t.Njj(a.precio_add=i)}),t.k0s()()}if(2&o){const e=t.XpG();t.R7$(3),t.Y8G("ngModel",e.precio_add)}}function Ut(o,s){if(1&o){const e=t.RV6();t.j41(0,"div",14)(1,"label",15),t.EFF(2,"Agregar Stock:(*)"),t.k0s(),t.j41(3,"input",32),t.bIt("ngModelChange",function(i){t.eBV(e);const a=t.XpG();return t.Njj(a.stock_add=i)}),t.k0s()()}if(2&o){const e=t.XpG();t.R7$(3),t.Y8G("ngModel",e.stock_add)}}function Xt(o,s){1&o&&t.nrm(0,"span",33)}let Bt=(()=>{class o{attributeService;modal;toastr;EspecificationE=new t.bkB;specification;attributes_variations=[];is_variation;isLoading$;specification_attribute_id="";type_attribute_specification=2;variations_attribute_id="";type_attribute_variation=4;attributes=[];dropdownList=[];selectedItems=[];dropdownSettings={};attributes_specifications=[];properties=[];propertie_id=null;value_add=null;specifications=[];precio_add=0;stock_add=0;constructor(e,n,i){this.attributeService=e,this.modal=n,this.toastr=i}ngOnInit(){this.isLoading$=this.attributeService.isLoading$,this.dropdownSettings={singleSelection:!1,idField:"id",textField:"name",selectAllText:"Select All",unSelectAllText:"UnSelect All",allowSearchFilter:!0},this.is_variation?(this.variations_attribute_id=this.specification.attribute_id,console.log(this.variations_attribute_id),this.changeVariations()):(this.specification_attribute_id=this.specification.attribute_id,this.changeSpecifications()),setTimeout(()=>{let e=this.type_attribute_specification;this.propertie_id=this.specification.propertie_id?this.specification.propertie_id:null,4==this.specification.attribute.type_attribute?(this.type_attribute_specification=0,this.selectedItems=this.specification.value_add?JSON.parse(this.specification.value_add):[],setTimeout(()=>{this.type_attribute_specification=e,this.isLoadingView()},25)):this.value_add=this.specification.value_add?this.specification.value_add:null},25),this.is_variation&&(this.precio_add=this.specification.add_price,this.stock_add=this.specification.stock)}store(){this.is_variation?this.storeVariation():this.storeSpecification()}storeSpecification(){4!=this.type_attribute_specification||0!=this.selectedItems.length?(this.selectedItems.length>0&&(this.value_add=JSON.stringify(this.selectedItems)),this.specification_attribute_id&&(this.propertie_id||this.value_add)?this.attributeService.updateSpecification(this.specification.id,{product_id:this.specification.product_id,attribute_id:this.specification_attribute_id,propertie_id:this.propertie_id,value_add:this.value_add}).subscribe(n=>{console.log(n),403==n.message?this.toastr.error("Validaci\xf3n",n.message_text):(this.toastr.success("Exito","Se actualizo la especificaci\xf3n correctamente"),this.EspecificationE.emit(n),this.modal.close())}):this.toastr.error("Validaci\xf3n","Llene los campos necesarios")):this.toastr.error("Validaci\xf3n","Necesitas seleccionar algunos items")}storeVariation(){this.variations_attribute_id&&(this.propertie_id||this.value_add)?this.attributeService.updateVariationsAnidadas(this.specification.id,{product_id:this.specification.product_id,attribute_id:this.variations_attribute_id,propertie_id:this.propertie_id,value_add:this.value_add,add_price:this.precio_add,stock:this.stock_add,product_variation_id:this.specification.product_variation_id}).subscribe(n=>{console.log(n),403==n.message?this.toastr.error("Validaci\xf3n",n.message_text):(this.toastr.success("Exito","Se actualizo la variaci\xf3n ANIDADA correctamente"),this.EspecificationE.emit(n),this.modal.close())}):this.toastr.error("Validaci\xf3n","Llene los campos necesarios")}onItemSelect(e){console.log(e)}onSelectAll(e){console.log(e)}isLoadingView(){this.attributeService.isLoadingSubject.next(!0),setTimeout(()=>{this.attributeService.isLoadingSubject.next(!1)},50)}changeSpecifications(){this.value_add=null,this.propertie_id=null,this.selectedItems=[];let e=this.attributes_specifications.find(n=>n.id==this.specification_attribute_id);e?(this.type_attribute_specification=e.type_attribute,3==this.type_attribute_specification||4==this.type_attribute_specification?(this.properties=e.properties,this.dropdownList=e.properties):(this.properties=[],this.dropdownList=[])):(this.type_attribute_specification=0,this.properties=[],this.dropdownList=[])}changeVariations(){this.value_add=null,this.propertie_id=null;let e=this.attributes_variations.find(n=>n.id==this.variations_attribute_id);e?(this.type_attribute_specification=e.type_attribute,this.properties=3==this.type_attribute_specification||4==this.type_attribute_specification?e.properties:[]):(this.type_attribute_specification=0,this.properties=[])}static \u0275fac=function(n){return new(n||o)(t.rXU(v),t.rXU(p.Lw),t.rXU(f.tw))};static \u0275cmp=t.VBU({type:o,selectors:[["app-edit-anidado-variations"]],inputs:{specification:"specification",attributes_variations:"attributes_variations",is_variation:"is_variation",attributes_specifications:"attributes_specifications"},outputs:{EspecificationE:"EspecificationE"},decls:33,vars:13,consts:[[1,"modal-content"],["id","kt_modal_add_user_header",1,"modal-header"],[1,"fw-bolder"],["data-kt-users-modal-action","close",1,"btn","btn-icon","btn-sm","btn-active-icon-primary",3,"click"],[1,"svg-icon","svg-icon-1"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none"],["opacity","0.5","x","6","y","17.3137","width","16","height","2","rx","1","transform","rotate(-45 6 17.3137)","fill","currentColor"],["x","7.41422","y","6","width","16","height","2","rx","1","transform","rotate(45 7.41422 6)","fill","currentColor"],[1,"modal-body","scroll-y","mx-5","my-7"],["id","kt_modal_add_user_form","action","#",1,"form"],[1,"row"],[1,"col-12"],[1,"row","align-items-center"],["class","col-6",4,"ngIf"],[1,"col-6"],[1,"fw-semibold","fs-6","py-2"],[4,"ngIf"],[1,"text-center","pt-15"],["type","reset",1,"btn","btn-light","me-3",3,"click"],["type","button","data-kt-users-modal-action","submit",1,"btn","btn-primary",3,"click"],[1,"indicator-label"],["class","spinner-border spinner-border-sm align-middle ms-2",4,"ngIf"],["name","specification_attribute_id","placeholder","Selec. Atributo",1,"form-control","form-select-solid","fw-bolder",3,"ngModel","ngModelChange","change"],["value",""],[4,"ngFor","ngForOf"],[3,"value"],["name","variations_attribute_id","placeholder","Selec. Atributo",1,"form-control","form-select-solid","fw-bolder",3,"ngModel","ngModelChange","change"],["type","text","name","value_add","placeholder","Por ejemplo:   The best note",1,"form-control","form-control-lg","form-control-solid",3,"ngModel","ngModelChange"],["type","number","name","value_add","placeholder","Por ejemplo:   34566",1,"form-control","form-control-lg","form-control-solid",3,"ngModel","ngModelChange"],["name","departament",1,"form-control","form-select-solid","fw-bolder",3,"ngModel","ngModelChange"],[3,"placeholder","settings","data","ngModelOptions","ngModel","ngModelChange","onSelect","onSelectAll"],["type","number","name","precio_add","placeholder","Por ejemplo:   15",1,"form-control","form-control-lg","form-control-solid",3,"ngModel","ngModelChange"],["type","number","name","stock_add","placeholder","Por ejemplo:   15",1,"form-control","form-control-lg","form-control-solid",3,"ngModel","ngModelChange"],[1,"spinner-border","spinner-border-sm","align-middle","ms-2"]],template:function(n,i){1&n&&(t.j41(0,"div",0)(1,"div",1)(2,"h2",2),t.EFF(3),t.k0s(),t.j41(4,"div",3),t.bIt("click",function(){return i.modal.dismiss()}),t.j41(5,"span",4),t.qSk(),t.j41(6,"svg",5),t.nrm(7,"rect",6)(8,"rect",7),t.k0s()()()(),t.joV(),t.j41(9,"div",8)(10,"form",9)(11,"div",10)(12,"div",11)(13,"div",12),t.DNE(14,Vt,7,2,"div",13),t.DNE(15,Dt,7,3,"div",13),t.j41(16,"div",14)(17,"label",15),t.EFF(18,"Campo: (*)"),t.k0s(),t.DNE(19,$t,2,1,"ng-container",16),t.DNE(20,Gt,2,1,"ng-container",16),t.DNE(21,Ot,5,2,"ng-container",16),t.DNE(22,Nt,2,6,"ng-container",16),t.k0s(),t.DNE(23,Yt,4,1,"div",13),t.DNE(24,Ut,4,1,"div",13),t.k0s()()(),t.j41(25,"div",17)(26,"button",18),t.bIt("click",function(){return i.modal.dismiss()}),t.EFF(27,"Cerrar"),t.k0s(),t.j41(28,"button",19),t.bIt("click",function(){return i.store()}),t.j41(29,"span",20),t.EFF(30,"Actualizar"),t.k0s(),t.DNE(31,Xt,1,0,"span",21),t.nI1(32,"async"),t.k0s()()()()()),2&n&&(t.R7$(3),t.Lme("Edit ",i.is_variation?"Variation":"Especification",' : "',i.specification.attribute.name,'"'),t.R7$(11),t.Y8G("ngIf",!i.is_variation),t.R7$(1),t.Y8G("ngIf",i.is_variation),t.R7$(4),t.Y8G("ngIf",1==i.type_attribute_specification),t.R7$(1),t.Y8G("ngIf",2==i.type_attribute_specification),t.R7$(1),t.Y8G("ngIf",3==i.type_attribute_specification),t.R7$(1),t.Y8G("ngIf",4==i.type_attribute_specification),t.R7$(1),t.Y8G("ngIf",i.is_variation),t.R7$(1),t.Y8G("ngIf",i.is_variation),t.R7$(7),t.Y8G("ngIf",t.bMT(32,11,i.isLoading$)))},dependencies:[d.Sq,d.bT,c.qT,c.xH,c.y7,c.me,c.Q0,c.wz,c.BC,c.cb,c.vS,c.cV,h.b,d.Jj]})}return o})();function qt(o,s){if(1&o&&(t.qex(0),t.j41(1,"option",29),t.EFF(2),t.k0s(),t.bVm()),2&o){const e=s.$implicit;t.R7$(1),t.Y8G("value",e.id),t.R7$(1),t.JRh(e.name)}}function zt(o,s){if(1&o&&(t.qex(0),t.j41(1,"option",29),t.EFF(2),t.k0s(),t.bVm()),2&o){const e=s.$implicit;t.R7$(1),t.Y8G("value",e.id),t.R7$(1),t.JRh(e.name)}}function Jt(o,s){if(1&o){const e=t.RV6();t.qex(0),t.j41(1,"select",30),t.bIt("ngModelChange",function(i){t.eBV(e);const a=t.XpG();return t.Njj(a.propertie_id=i)}),t.j41(2,"option",16),t.EFF(3,"Selec."),t.k0s(),t.DNE(4,zt,3,2,"ng-container",17),t.k0s(),t.bVm()}if(2&o){const e=t.XpG();t.R7$(1),t.Y8G("ngModel",e.propertie_id),t.R7$(3),t.Y8G("ngForOf",e.properties)}}function Kt(o,s){if(1&o){const e=t.RV6();t.qex(0),t.j41(1,"input",31),t.bIt("ngModelChange",function(i){t.eBV(e);const a=t.XpG();return t.Njj(a.value_add=i)}),t.k0s(),t.bVm()}if(2&o){const e=t.XpG();t.R7$(1),t.Y8G("ngModel",e.value_add)}}function Ht(o,s){if(1&o){const e=t.RV6();t.qex(0),t.j41(1,"tr")(2,"td")(3,"div",32)(4,"div",33)(5,"span",34)(6,"i",35),t.nrm(7,"span",36)(8,"span",37)(9,"span",38)(10,"span",39)(11,"span",40)(12,"span",41)(13,"span",42)(14,"span",43),t.k0s()()(),t.j41(15,"div",44)(16,"a",45),t.EFF(17),t.k0s()()()(),t.j41(18,"td")(19,"a",46),t.EFF(20),t.k0s()(),t.j41(21,"td")(22,"span",47),t.EFF(23),t.k0s()(),t.j41(24,"td")(25,"span",47),t.EFF(26),t.k0s()(),t.j41(27,"td",48)(28,"a",49),t.bIt("click",function(){const a=t.eBV(e).$implicit,r=t.XpG();return t.Njj(r.editVariation(a))}),t.j41(29,"i",50),t.nrm(30,"span",36)(31,"span",37),t.k0s()(),t.j41(32,"a",51),t.bIt("click",function(){const a=t.eBV(e).$implicit,r=t.XpG();return t.Njj(r.deleteVariation(a))}),t.j41(33,"i",52),t.nrm(34,"span",36)(35,"span",37)(36,"span",38)(37,"span",39)(38,"span",40),t.k0s()()()(),t.bVm()}if(2&o){const e=s.$implicit,n=t.XpG();t.R7$(17),t.SpI(" ",e.attribute.name," "),t.R7$(3),t.SpI(" ",n.getValueAttribute(e)," "),t.R7$(3),t.JRh(e.add_price),t.R7$(3),t.JRh(e.stock)}}let Qt=(()=>{class o{attributeService;modal;toastr;modalService;variation;specification_attribute_id="";type_attribute_specification=2;variations_attribute_id="";type_attribute_variation=4;attributes=[];precio_add=0;stock_add=0;attributes_specifications=[];attributes_variations=[];properties=[];propertie_id=null;value_add=null;specifications=[];variations=[];isLoading$;constructor(e,n,i,a){this.attributeService=e,this.modal=n,this.toastr=i,this.modalService=a}ngOnInit(){this.isLoading$=this.attributeService.isLoading$,this.listVariationsAnidadas()}listVariationsAnidadas(){this.attributeService.listVariationsAnidadas(this.variation.product_id,this.variation.id).subscribe(e=>{this.variations=e.variations})}changeVariations(){this.value_add=null,this.propertie_id=null;let e=this.attributes_variations.find(n=>n.id==this.variations_attribute_id);e?(this.type_attribute_variation=e.type_attribute,this.properties=3==this.type_attribute_variation||4==this.type_attribute_variation?e.properties:[]):(this.type_attribute_variation=0,this.properties=[])}getValueAttribute(e){return e.propertie_id?e.propertie.name:e.value_add?e.value_add:"---"}saveVariation(){this.variations_attribute_id&&(this.propertie_id||this.value_add)?this.precio_add<0?this.toastr.error("Validaci\xf3n","El valor del precio debe ser mayor o igual"):this.stock_add<=0?this.toastr.error("Validaci\xf3n","El stock debe ser mayor a 0"):this.attributeService.createVariationsAnidadas({product_id:this.variation.product_id,attribute_id:this.variations_attribute_id,propertie_id:this.propertie_id,value_add:this.value_add,add_price:this.precio_add,stock:this.stock_add,product_variation_id:this.variation.id}).subscribe(n=>{console.log(n),403==n.message?this.toastr.error("Validaci\xf3n",n.message_text):(this.toastr.success("Exito","Se registro la variaci\xf3n ANIDADA correctamente"),this.variations.unshift(n.variation),this.value_add=null,this.propertie_id=null,this.variations_attribute_id="",this.precio_add=0,this.stock_add=0)}):this.toastr.error("Validaci\xf3n","Llene los campos necesarios")}editVariation(e){const n=this.modalService.open(Bt,{centered:!0,size:"md"});n.componentInstance.specification=e,n.componentInstance.attributes_variations=this.attributes_variations,n.componentInstance.is_variation=1,n.componentInstance.EspecificationE.subscribe(i=>{console.log(i);let a=this.variations.findIndex(r=>r.id==i.variation.id);-1!=a&&(this.variations[a]=i.variation)})}deleteVariation(e){const n=this.modalService.open(k,{centered:!0,size:"md"});n.componentInstance.specification=e,n.componentInstance.is_variation=1,n.componentInstance.EspecificationD.subscribe(i=>{console.log(i);let a=this.variations.findIndex(r=>r.id==e.id);-1!=a&&this.variations.splice(a,1)})}static \u0275fac=function(n){return new(n||o)(t.rXU(v),t.rXU(p.Lw),t.rXU(f.tw),t.rXU(p.Bq))};static \u0275cmp=t.VBU({type:o,selectors:[["app-create-anidado-variations"]],inputs:{variation:"variation",attributes_variations:"attributes_variations"},decls:64,vars:8,consts:[[1,"modal-content"],["id","kt_modal_add_user_header",1,"modal-header"],[1,"fw-bolder"],["data-kt-users-modal-action","close",1,"btn","btn-icon","btn-sm","btn-active-icon-primary",3,"click"],[1,"svg-icon","svg-icon-1"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none"],["opacity","0.5","x","6","y","17.3137","width","16","height","2","rx","1","transform","rotate(-45 6 17.3137)","fill","currentColor"],["x","7.41422","y","6","width","16","height","2","rx","1","transform","rotate(45 7.41422 6)","fill","currentColor"],[1,"modal-body","scroll-y","mx-5","my-7"],["id","kt_modal_add_user_form","action","#",1,"form"],[1,"row"],[1,"col-12"],[1,"row","align-items-center"],[1,"col-4"],[1,"fw-semibold","fs-6","py-2"],["name","variations_attribute_id","placeholder","Selec. Atributo",1,"form-control","form-select-solid","fw-bolder",3,"ngModel","ngModelChange","change"],["value",""],[4,"ngFor","ngForOf"],[4,"ngIf"],["type","number","name","precio_add","placeholder","Por ejemplo:   15",1,"form-control","form-control-lg","form-control-solid",3,"ngModel","ngModelChange"],["type","number","name","stock_add","placeholder","Por ejemplo:   15",1,"form-control","form-control-lg","form-control-solid",3,"ngModel","ngModelChange"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"row","my-4"],[1,"table-responsive"],[1,"table","align-middle","gs-0","gy-4"],[1,"fw-bold","text-muted","bg-light"],[1,""],[1,"text-center","pt-15"],["type","reset",1,"btn","btn-light","me-3",3,"click"],[3,"value"],["name","departament",1,"form-control","form-select-solid","fw-bolder",3,"ngModel","ngModelChange"],["type","text","name","value_add","placeholder","Por ejemplo:   The best note",1,"form-control","form-control-lg","form-control-solid",3,"ngModel","ngModelChange"],[1,"d-flex","align-items-center"],[1,"symbol","symbol-50px","me-2"],[1,"symbol-label","bg-light-info"],[1,"ki-duotone","ki-scan-barcode","fs-2x","text-info"],[1,"path1"],[1,"path2"],[1,"path3"],[1,"path4"],[1,"path5"],[1,"path6"],[1,"path7"],[1,"path8"],[1,"d-flex","justify-content-start","flex-column"],["href","#",1,"text-gray-900","fw-bold","text-hover-primary","mb-1","fs-6"],["href","#","onclick","return false;",1,"text-gray-900","fw-bold","text-hover-primary","d-block","mb-1","fs-6"],[1,"text-muted","fw-semibold","text-muted","d-block","fs-7"],[1,"text-end"],["href","#","onclick","return false;",1,"btn","btn-icon","btn-bg-light","btn-active-color-primary","btn-sm","me-1",3,"click"],[1,"ki-duotone","ki-pencil","fs-2"],["href","#","onclick","return false;",1,"btn","btn-icon","btn-bg-light","btn-active-color-primary","btn-sm",3,"click"],[1,"ki-duotone","ki-trash","fs-2"]],template:function(n,i){1&n&&(t.j41(0,"div",0)(1,"div",1)(2,"h2",2),t.EFF(3),t.k0s(),t.j41(4,"div",3),t.bIt("click",function(){return i.modal.dismiss()}),t.j41(5,"span",4),t.qSk(),t.j41(6,"svg",5),t.nrm(7,"rect",6)(8,"rect",7),t.k0s()()()(),t.joV(),t.j41(9,"div",8)(10,"form",9)(11,"div",10)(12,"div",11)(13,"div",12)(14,"div",13)(15,"div",10)(16,"div",11)(17,"label",14),t.EFF(18,"Atributos:(*)"),t.k0s(),t.j41(19,"select",15),t.bIt("ngModelChange",function(r){return i.variations_attribute_id=r})("change",function(){return i.changeVariations()}),t.j41(20,"option",16),t.EFF(21,"Selec."),t.k0s(),t.DNE(22,qt,3,2,"ng-container",17),t.k0s()(),t.j41(23,"div",11)(24,"label",14),t.EFF(25,"Campo: (*)"),t.k0s(),t.DNE(26,Jt,5,2,"ng-container",18),t.DNE(27,Kt,2,1,"ng-container",18),t.k0s()()(),t.j41(28,"div",13)(29,"div",10)(30,"div",11)(31,"label",14),t.EFF(32,"Agregar Precio:(Opcional)"),t.k0s(),t.j41(33,"input",19),t.bIt("ngModelChange",function(r){return i.precio_add=r}),t.k0s()(),t.j41(34,"div",11)(35,"label",14),t.EFF(36,"Agregar Stock:(*)"),t.k0s(),t.j41(37,"input",20),t.bIt("ngModelChange",function(r){return i.stock_add=r}),t.k0s()()()(),t.j41(38,"div",13)(39,"label",14),t.EFF(40,"Agregar:(*)"),t.k0s(),t.nrm(41,"br"),t.j41(42,"button",21),t.bIt("click",function(){return i.saveVariation()}),t.EFF(43," +"),t.k0s()()()()(),t.j41(44,"div",22)(45,"div",11)(46,"div",23)(47,"table",24)(48,"thead")(49,"tr",25)(50,"th",26),t.EFF(51,"Atributo V."),t.k0s(),t.j41(52,"th",26),t.EFF(53,"Valor"),t.k0s(),t.j41(54,"th",26),t.EFF(55,"Precio Adicional"),t.k0s(),t.j41(56,"th",26),t.EFF(57,"Stock"),t.k0s(),t.nrm(58,"th",26),t.k0s()(),t.j41(59,"tbody"),t.DNE(60,Ht,39,4,"ng-container",17),t.k0s()()()()(),t.j41(61,"div",27)(62,"button",28),t.bIt("click",function(){return i.modal.dismiss()}),t.EFF(63,"Cerrar"),t.k0s()()()()()),2&n&&(t.R7$(3),t.SpI('Gesti\xf3n Anidado : "',i.variation.attribute.name,'"'),t.R7$(16),t.Y8G("ngModel",i.variations_attribute_id),t.R7$(3),t.Y8G("ngForOf",i.attributes_variations),t.R7$(4),t.Y8G("ngIf",3==i.type_attribute_variation),t.R7$(1),t.Y8G("ngIf",1==i.type_attribute_variation),t.R7$(6),t.Y8G("ngModel",i.precio_add),t.R7$(4),t.Y8G("ngModel",i.stock_add),t.R7$(23),t.Y8G("ngForOf",i.variations))},dependencies:[d.Sq,d.bT,c.qT,c.xH,c.y7,c.me,c.Q0,c.wz,c.BC,c.cb,c.vS,c.cV]})}return o})();function Wt(o,s){1&o&&t.nrm(0,"span",30)}function Zt(o,s){if(1&o&&(t.qex(0),t.j41(1,"option",31),t.EFF(2),t.k0s(),t.bVm()),2&o){const e=s.$implicit;t.R7$(1),t.Y8G("value",e.id),t.R7$(1),t.JRh(e.name)}}function te(o,s){if(1&o){const e=t.RV6();t.qex(0),t.j41(1,"input",32),t.bIt("ngModelChange",function(i){t.eBV(e);const a=t.XpG();return t.Njj(a.value_add=i)}),t.k0s(),t.bVm()}if(2&o){const e=t.XpG();t.R7$(1),t.Y8G("ngModel",e.value_add)}}function ee(o,s){if(1&o){const e=t.RV6();t.qex(0),t.j41(1,"input",33),t.bIt("ngModelChange",function(i){t.eBV(e);const a=t.XpG();return t.Njj(a.value_add=i)}),t.k0s(),t.bVm()}if(2&o){const e=t.XpG();t.R7$(1),t.Y8G("ngModel",e.value_add)}}function ie(o,s){if(1&o&&(t.qex(0),t.j41(1,"option",31),t.EFF(2),t.k0s(),t.bVm()),2&o){const e=s.$implicit;t.R7$(1),t.Y8G("value",e.id),t.R7$(1),t.JRh(e.name)}}function ne(o,s){if(1&o){const e=t.RV6();t.qex(0),t.j41(1,"select",34),t.bIt("ngModelChange",function(i){t.eBV(e);const a=t.XpG();return t.Njj(a.propertie_id=i)}),t.j41(2,"option",16),t.EFF(3,"Selec."),t.k0s(),t.DNE(4,ie,3,2,"ng-container",17),t.k0s(),t.bVm()}if(2&o){const e=t.XpG();t.R7$(1),t.Y8G("ngModel",e.propertie_id),t.R7$(3),t.Y8G("ngForOf",e.properties)}}function oe(o,s){if(1&o){const e=t.RV6();t.qex(0),t.j41(1,"ng-multiselect-dropdown",35),t.bIt("ngModelChange",function(i){t.eBV(e);const a=t.XpG();return t.Njj(a.selectedItems=i)})("onSelect",function(i){t.eBV(e);const a=t.XpG();return t.Njj(a.onItemSelect(i))})("onSelectAll",function(i){t.eBV(e);const a=t.XpG();return t.Njj(a.onSelectAll(i))}),t.k0s(),t.bVm()}if(2&o){const e=t.XpG();t.R7$(1),t.Y8G("placeholder","custom placeholder")("settings",e.dropdownSettings)("data",e.dropdownList)("ngModel",e.selectedItems)}}function ae(o,s){if(1&o&&(t.qex(0),t.j41(1,"option",31),t.EFF(2),t.k0s(),t.bVm()),2&o){const e=s.$implicit;t.R7$(1),t.Y8G("value",e.id),t.R7$(1),t.JRh(e.name)}}function re(o,s){if(1&o&&(t.qex(0),t.j41(1,"option",31),t.EFF(2),t.k0s(),t.bVm()),2&o){const e=s.$implicit;t.R7$(1),t.Y8G("value",e.id),t.R7$(1),t.JRh(e.name)}}function se(o,s){if(1&o){const e=t.RV6();t.qex(0),t.j41(1,"select",34),t.bIt("ngModelChange",function(i){t.eBV(e);const a=t.XpG();return t.Njj(a.propertie_id=i)}),t.j41(2,"option",16),t.EFF(3,"Selec."),t.k0s(),t.DNE(4,re,3,2,"ng-container",17),t.k0s(),t.bVm()}if(2&o){const e=t.XpG();t.R7$(1),t.Y8G("ngModel",e.propertie_id),t.R7$(3),t.Y8G("ngForOf",e.properties)}}function ce(o,s){if(1&o){const e=t.RV6();t.qex(0),t.j41(1,"input",32),t.bIt("ngModelChange",function(i){t.eBV(e);const a=t.XpG();return t.Njj(a.value_add=i)}),t.k0s(),t.bVm()}if(2&o){const e=t.XpG();t.R7$(1),t.Y8G("ngModel",e.value_add)}}function de(o,s){if(1&o){const e=t.RV6();t.qex(0),t.j41(1,"tr")(2,"td")(3,"div",36)(4,"div",37)(5,"span",38)(6,"i",39),t.nrm(7,"span",40)(8,"span",41)(9,"span",42),t.k0s()()(),t.j41(10,"div",43)(11,"a",44),t.EFF(12),t.k0s()()()(),t.j41(13,"td")(14,"a",45),t.EFF(15),t.k0s()(),t.j41(16,"td",46)(17,"a",47),t.bIt("click",function(){const a=t.eBV(e).$implicit,r=t.XpG();return t.Njj(r.editSpecification(a))}),t.j41(18,"i",48),t.nrm(19,"span",40)(20,"span",41),t.k0s()(),t.j41(21,"a",49),t.bIt("click",function(){const a=t.eBV(e).$implicit,r=t.XpG();return t.Njj(r.deleteSpecification(a))}),t.j41(22,"i",50),t.nrm(23,"span",40)(24,"span",41)(25,"span",42)(26,"span",51)(27,"span",52),t.k0s()()()(),t.bVm()}if(2&o){const e=s.$implicit,n=t.XpG();t.R7$(12),t.SpI(" ",e.attribute.name," "),t.R7$(3),t.SpI(" ",n.getValueAttribute(e)," ")}}function le(o,s){if(1&o){const e=t.RV6();t.qex(0),t.j41(1,"tr")(2,"td")(3,"div",36)(4,"div",37)(5,"span",53)(6,"i",54),t.nrm(7,"span",40)(8,"span",41)(9,"span",42)(10,"span",51)(11,"span",52)(12,"span",55)(13,"span",56)(14,"span",57),t.k0s()()(),t.j41(15,"div",43)(16,"a",44),t.EFF(17),t.k0s()()()(),t.j41(18,"td")(19,"a",45),t.EFF(20),t.k0s()(),t.j41(21,"td")(22,"span",58),t.EFF(23),t.k0s()(),t.j41(24,"td")(25,"span",58),t.EFF(26),t.k0s()(),t.j41(27,"td",46)(28,"a",47),t.bIt("click",function(){const a=t.eBV(e).$implicit,r=t.XpG();return t.Njj(r.openAnidado(a))}),t.j41(29,"i",59),t.nrm(30,"span",40)(31,"span",41),t.k0s()(),t.j41(32,"a",47),t.bIt("click",function(){const a=t.eBV(e).$implicit,r=t.XpG();return t.Njj(r.editVariation(a))}),t.j41(33,"i",48),t.nrm(34,"span",40)(35,"span",41),t.k0s()(),t.j41(36,"a",49),t.bIt("click",function(){const a=t.eBV(e).$implicit,r=t.XpG();return t.Njj(r.deleteVariation(a))}),t.j41(37,"i",50),t.nrm(38,"span",40)(39,"span",41)(40,"span",42)(41,"span",51)(42,"span",52),t.k0s()()()(),t.bVm()}if(2&o){const e=s.$implicit,n=t.XpG();t.R7$(17),t.SpI(" ",e.attribute.name," "),t.R7$(3),t.SpI(" ",n.getValueAttribute(e)," "),t.R7$(3),t.JRh(e.add_price),t.R7$(3),t.JRh(e.stock)}}let pe=(()=>{class o{attributeService;toastr;activedRoute;modalService;title="";sku="";isLoading$;specification_attribute_id="";type_attribute_specification=2;variations_attribute_id="";type_attribute_variation=4;attributes=[];dropdownList=[];selectedItems=[];dropdownSettings={};word="";isShowMultiselect=!1;PRODUCT_ID="";PRODUCT_SELECTED;campo_1="";campo_2=0;campo_3;campo_1_variation;dropdownListVariations=[];selectedItemsVariations=[];precio_add=0;stock_add=0;attributes_specifications=[];attributes_variations=[];properties=[];propertie_id=null;value_add=null;specifications=[];variations=[];constructor(e,n,i,a){this.attributeService=e,this.toastr=n,this.activedRoute=i,this.modalService=a}ngOnInit(){this.isLoading$=this.attributeService.isLoading$,this.dropdownSettings={singleSelection:!1,idField:"id",textField:"name",selectAllText:"Select All",unSelectAllText:"UnSelect All",allowSearchFilter:!0},this.activedRoute.params.subscribe(e=>{console.log(e),this.PRODUCT_ID=e.id}),this.showProduct(),this.configAll(),this.listSpecification(),this.listVariations()}configAll(){this.attributeService.configAll().subscribe(e=>{console.log(e),this.attributes_specifications=e.attributes_specifications,this.attributes_variations=e.attributes_variations})}listSpecification(){this.attributeService.listSpecification(this.PRODUCT_ID).subscribe(e=>{console.log(e),this.specifications=e.specifications})}listVariations(){this.attributeService.listVariations(this.PRODUCT_ID).subscribe(e=>{console.log(e),this.variations=e.variations})}showProduct(){this.attributeService.showProduct(this.PRODUCT_ID).subscribe(e=>{console.log(e),this.PRODUCT_SELECTED=e.product,this.title=e.product.title,this.sku=e.product.sku})}changeSpecifications(){this.value_add=null,this.propertie_id=null,this.selectedItems=[];let e=this.attributes_specifications.find(n=>n.id==this.specification_attribute_id);e?(this.type_attribute_specification=e.type_attribute,3==this.type_attribute_specification||4==this.type_attribute_specification?(this.properties=e.properties,this.dropdownList=e.properties):(this.properties=[],this.dropdownList=[])):(this.type_attribute_specification=0,this.properties=[],this.dropdownList=[])}changeVariations(){this.value_add=null,this.propertie_id=null;let e=this.attributes_variations.find(n=>n.id==this.variations_attribute_id);e?(this.type_attribute_variation=e.type_attribute,this.properties=3==this.type_attribute_variation||4==this.type_attribute_variation?e.properties:[]):(this.type_attribute_variation=0,this.properties=[])}addItems(){this.isShowMultiselect=!0;let e=(new Date).getTime();this.dropdownList.push({item_id:e,item_text:this.word}),this.selectedItems.push({item_id:e,item_text:this.word}),setTimeout(()=>{this.word="",this.isShowMultiselect=!1,this.isLoadingView()},100)}onItemSelect(e){console.log(e)}onSelectAll(e){console.log(e)}isLoadingView(){this.attributeService.isLoadingSubject.next(!0),setTimeout(()=>{this.attributeService.isLoadingSubject.next(!1)},50)}save(){4!=this.type_attribute_specification||0!=this.selectedItems.length?(this.selectedItems.length>0&&(this.value_add=JSON.stringify(this.selectedItems)),this.specification_attribute_id&&(this.propertie_id||this.value_add)?this.attributeService.createSpecification({product_id:this.PRODUCT_ID,attribute_id:this.specification_attribute_id,propertie_id:this.propertie_id,value_add:this.value_add}).subscribe(n=>{console.log(n),403==n.message?this.toastr.error("Validaci\xf3n",n.message_text):(this.toastr.success("Exito","Se registro la especificaci\xf3n correctamente"),this.specifications.unshift(n.specification),this.value_add=null,this.propertie_id=null,this.specification_attribute_id="")}):this.toastr.error("Validaci\xf3n","Llene los campos necesarios")):this.toastr.error("Validaci\xf3n","Necesitas seleccionar algunos items")}editSpecification(e){const n=this.modalService.open(x,{centered:!0,size:"md"});n.componentInstance.specification=e,n.componentInstance.attributes_specifications=this.attributes_specifications,n.componentInstance.EspecificationE.subscribe(i=>{console.log(i);let a=this.specifications.findIndex(r=>r.id==i.specification.id);-1!=a&&(this.specifications[a]=i.specification)})}deleteSpecification(e){const n=this.modalService.open(k,{centered:!0,size:"md"});n.componentInstance.specification=e,n.componentInstance.EspecificationD.subscribe(i=>{console.log(i);let a=this.specifications.findIndex(r=>r.id==e.id);-1!=a&&this.specifications.splice(a,1)})}getValueAttribute(e){return e.propertie_id?e.propertie.name:e.value_add?e.value_add:"---"}saveVariation(){this.variations_attribute_id&&(this.propertie_id||this.value_add)?this.precio_add<0?this.toastr.error("Validaci\xf3n","El valor del precio debe ser mayor o igual"):this.stock_add<=0?this.toastr.error("Validaci\xf3n","El stock debe ser mayor a 0"):this.attributeService.createVariations({product_id:this.PRODUCT_ID,attribute_id:this.variations_attribute_id,propertie_id:this.propertie_id,value_add:this.value_add,add_price:this.precio_add,stock:this.stock_add}).subscribe(n=>{console.log(n),403==n.message?this.toastr.error("Validaci\xf3n",n.message_text):(this.toastr.success("Exito","Se registro la variaci\xf3n correctamente"),this.variations.unshift(n.variation),this.value_add=null,this.propertie_id=null,this.variations_attribute_id="",this.precio_add=0,this.stock_add=0)}):this.toastr.error("Validaci\xf3n","Llene los campos necesarios")}editVariation(e){const n=this.modalService.open(x,{centered:!0,size:"md"});n.componentInstance.specification=e,n.componentInstance.attributes_specifications=this.attributes_specifications,n.componentInstance.attributes_variations=this.attributes_variations,n.componentInstance.is_variation=1,n.componentInstance.EspecificationE.subscribe(i=>{console.log(i);let a=this.variations.findIndex(r=>r.id==i.variation.id);-1!=a&&(this.variations[a]=i.variation)})}deleteVariation(e){const n=this.modalService.open(k,{centered:!0,size:"md"});n.componentInstance.specification=e,n.componentInstance.is_variation=1,n.componentInstance.EspecificationD.subscribe(i=>{console.log(i);let a=this.variations.findIndex(r=>r.id==e.id);-1!=a&&this.variations.splice(a,1)})}openAnidado(e){const n=this.modalService.open(Qt,{centered:!0,size:"lg"});n.componentInstance.variation=e,n.componentInstance.attributes_variations=this.attributes_variations}static \u0275fac=function(n){return new(n||o)(t.rXU(v),t.rXU(f.tw),t.rXU(_.nX),t.rXU(p.Bq))};static \u0275cmp=t.VBU({type:o,selectors:[["app-create-variation-specifications"]],decls:108,vars:19,consts:[[1,"card"],["class","spinner-border spinner-border-sm align-middle ms-2",4,"ngIf"],[1,"card-body","border-top","p-9"],[1,"row","mb-6"],[1,"col-lg-8","fv-row","fv-plugins-icon-container"],[1,"fw-semibold","fs-6","py-2"],["type","text","name","title","disabled","","placeholder","Por ejemplo:   The best note book collection 2023 ",1,"form-control","form-control-lg","form-control-solid",3,"ngModel","ngModelChange"],[1,"col-lg-4","fv-row","fv-plugins-icon-container"],["type","text","name","sku","disabled","","placeholder","Por ejemplo:   ZDR456 ",1,"form-control","form-control-lg","form-control-solid",3,"ngModel","ngModelChange"],[1,"row","mb-6","align-items-center"],[1,"col-6"],[1,"row"],[1,"col-12"],[1,"row","align-items-center"],[1,"col-4"],["name","specification_attribute_id","placeholder","Selec. Atributo",1,"form-control","form-select-solid","fw-bolder",3,"ngModel","ngModelChange","change"],["value",""],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"btn","btn-primary","btn-sm",3,"click"],["name","variations_attribute_id","placeholder","Selec. Atributo",1,"form-control","form-select-solid","fw-bolder",3,"ngModel","ngModelChange","change"],["type","number","name","precio_add","placeholder","Por ejemplo:   15",1,"form-control","form-control-lg","form-control-solid",3,"ngModel","ngModelChange"],["type","number","name","stock_add","placeholder","Por ejemplo:   15",1,"form-control","form-control-lg","form-control-solid",3,"ngModel","ngModelChange"],[1,"table-responsive"],[1,"table","align-middle","gs-0","gy-4"],[1,"fw-bold","text-muted","bg-light"],[1,"ps-4","min-w-325px","rounded-start"],[1,"min-w-125px"],[1,"min-w-200px","text-end","rounded-end"],[1,""],[1,"spinner-border","spinner-border-sm","align-middle","ms-2"],[3,"value"],["type","text","name","value_add","placeholder","Por ejemplo:   The best note",1,"form-control","form-control-lg","form-control-solid",3,"ngModel","ngModelChange"],["type","number","name","value_add","placeholder","Por ejemplo:   34566",1,"form-control","form-control-lg","form-control-solid",3,"ngModel","ngModelChange"],["name","departament",1,"form-control","form-select-solid","fw-bolder",3,"ngModel","ngModelChange"],[3,"placeholder","settings","data","ngModel","ngModelChange","onSelect","onSelectAll"],[1,"d-flex","align-items-center"],[1,"symbol","symbol-50px","me-2"],[1,"symbol-label","bg-light-primary"],[1,"ki-duotone","ki-shield-search","fs-2x","text-primary"],[1,"path1"],[1,"path2"],[1,"path3"],[1,"d-flex","justify-content-start","flex-column"],["href","#",1,"text-gray-900","fw-bold","text-hover-primary","mb-1","fs-6"],["href","#","onclick","return false;",1,"text-gray-900","fw-bold","text-hover-primary","d-block","mb-1","fs-6"],[1,"text-end"],["href","#","onclick","return false;",1,"btn","btn-icon","btn-bg-light","btn-active-color-primary","btn-sm","me-1",3,"click"],[1,"ki-duotone","ki-pencil","fs-2"],["href","#","onclick","return false;",1,"btn","btn-icon","btn-bg-light","btn-active-color-primary","btn-sm",3,"click"],[1,"ki-duotone","ki-trash","fs-2"],[1,"path4"],[1,"path5"],[1,"symbol-label","bg-light-info"],[1,"ki-duotone","ki-scan-barcode","fs-2x","text-info"],[1,"path6"],[1,"path7"],[1,"path8"],[1,"text-muted","fw-semibold","text-muted","d-block","fs-7"],[1,"ki-duotone","ki-questionnaire-tablet","fs-2"]],template:function(n,i){1&n&&(t.j41(0,"div",0),t.DNE(1,Wt,1,0,"span",1),t.nI1(2,"async"),t.j41(3,"div",2)(4,"div",3)(5,"div",4)(6,"label",5),t.EFF(7,"Titulo: (*)"),t.k0s(),t.j41(8,"input",6),t.bIt("ngModelChange",function(r){return i.title=r}),t.k0s()(),t.j41(9,"div",7)(10,"label",5),t.EFF(11,"Sku: (*)"),t.k0s(),t.j41(12,"input",8),t.bIt("ngModelChange",function(r){return i.sku=r}),t.k0s()()(),t.j41(13,"div",9)(14,"div",10)(15,"label",5),t.EFF(16,"Especificaciones: (*)"),t.k0s(),t.j41(17,"div",11)(18,"div",12)(19,"div",13)(20,"div",14)(21,"label",5),t.EFF(22,"Atributos:(*)"),t.k0s(),t.j41(23,"select",15),t.bIt("ngModelChange",function(r){return i.specification_attribute_id=r})("change",function(){return i.changeSpecifications()}),t.j41(24,"option",16),t.EFF(25,"Selec."),t.k0s(),t.DNE(26,Zt,3,2,"ng-container",17),t.k0s()(),t.j41(27,"div",14)(28,"label",5),t.EFF(29,"Campo: (*)"),t.k0s(),t.DNE(30,te,2,1,"ng-container",18),t.DNE(31,ee,2,1,"ng-container",18),t.DNE(32,ne,5,2,"ng-container",18),t.DNE(33,oe,2,4,"ng-container",18),t.k0s(),t.j41(34,"div",14)(35,"label",5),t.EFF(36,"Agregar:(*)"),t.k0s(),t.nrm(37,"br"),t.j41(38,"button",19),t.bIt("click",function(){return i.save()}),t.EFF(39," +"),t.k0s()()()()()(),t.j41(40,"div",10)(41,"label",5),t.EFF(42,"Variaciones: (*)"),t.k0s(),t.j41(43,"div",13)(44,"div",12)(45,"div",13)(46,"div",14)(47,"div",11)(48,"div",12)(49,"label",5),t.EFF(50,"Atributos:(*)"),t.k0s(),t.j41(51,"select",20),t.bIt("ngModelChange",function(r){return i.variations_attribute_id=r})("change",function(){return i.changeVariations()}),t.j41(52,"option",16),t.EFF(53,"Selec."),t.k0s(),t.DNE(54,ae,3,2,"ng-container",17),t.k0s()(),t.j41(55,"div",12)(56,"label",5),t.EFF(57,"Campo: (*)"),t.k0s(),t.DNE(58,se,5,2,"ng-container",18),t.DNE(59,ce,2,1,"ng-container",18),t.k0s()()(),t.j41(60,"div",14)(61,"div",11)(62,"div",12)(63,"label",5),t.EFF(64,"Agregar Precio:(Opcional)"),t.k0s(),t.j41(65,"input",21),t.bIt("ngModelChange",function(r){return i.precio_add=r}),t.k0s()(),t.j41(66,"div",12)(67,"label",5),t.EFF(68,"Agregar Stock:(*)"),t.k0s(),t.j41(69,"input",22),t.bIt("ngModelChange",function(r){return i.stock_add=r}),t.k0s()()()(),t.j41(70,"div",14)(71,"label",5),t.EFF(72,"Agregar:(*)"),t.k0s(),t.nrm(73,"br"),t.j41(74,"button",19),t.bIt("click",function(){return i.saveVariation()}),t.EFF(75," +"),t.k0s()()()()()(),t.j41(76,"div",10)(77,"div",11)(78,"div",12)(79,"div",23)(80,"table",24)(81,"thead")(82,"tr",25)(83,"th",26),t.EFF(84,"Atributo E."),t.k0s(),t.j41(85,"th",27),t.EFF(86,"Valor"),t.k0s(),t.nrm(87,"th",28),t.k0s()(),t.j41(88,"tbody"),t.DNE(89,de,28,2,"ng-container",17),t.k0s()()()()()(),t.j41(90,"div",10)(91,"div",11)(92,"div",12)(93,"div",23)(94,"table",24)(95,"thead")(96,"tr",25)(97,"th",29),t.EFF(98,"Atributo V."),t.k0s(),t.j41(99,"th",29),t.EFF(100,"Valor"),t.k0s(),t.j41(101,"th",29),t.EFF(102,"Precio Adicional"),t.k0s(),t.j41(103,"th",29),t.EFF(104,"Stock"),t.k0s(),t.nrm(105,"th",29),t.k0s()(),t.j41(106,"tbody"),t.DNE(107,le,43,4,"ng-container",17),t.k0s()()()()()()()()()),2&n&&(t.R7$(1),t.Y8G("ngIf",t.bMT(2,17,i.isLoading$)),t.R7$(7),t.Y8G("ngModel",i.title),t.R7$(4),t.Y8G("ngModel",i.sku),t.R7$(11),t.Y8G("ngModel",i.specification_attribute_id),t.R7$(3),t.Y8G("ngForOf",i.attributes_specifications),t.R7$(4),t.Y8G("ngIf",1==i.type_attribute_specification),t.R7$(1),t.Y8G("ngIf",2==i.type_attribute_specification),t.R7$(1),t.Y8G("ngIf",3==i.type_attribute_specification),t.R7$(1),t.Y8G("ngIf",4==i.type_attribute_specification),t.R7$(18),t.Y8G("ngModel",i.variations_attribute_id),t.R7$(3),t.Y8G("ngForOf",i.attributes_variations),t.R7$(4),t.Y8G("ngIf",3==i.type_attribute_variation),t.R7$(1),t.Y8G("ngIf",1==i.type_attribute_variation),t.R7$(6),t.Y8G("ngModel",i.precio_add),t.R7$(4),t.Y8G("ngModel",i.stock_add),t.R7$(20),t.Y8G("ngForOf",i.specifications),t.R7$(18),t.Y8G("ngForOf",i.variations))},dependencies:[d.Sq,d.bT,c.xH,c.y7,c.me,c.Q0,c.wz,c.BC,c.vS,h.b,d.Jj]})}return o})();var ue=l(4956);let C=(()=>{class o{permissionService;router;constructor(e,n){this.permissionService=e,this.router=n}canActivate(e,n){console.log("PermissionGuard: verificando acceso a ruta",n.url);const i=e.data.permission,a=e.data.role;if(!i&&!a)return console.log("No hay requisitos de permisos para esta ruta, permitiendo acceso"),!0;if(i){const r=this.permissionService.hasPermission(i);if(console.log(`Verificando permiso ${i}: ${r}`),!r)return console.log("Permiso denegado, redirigiendo a error 404"),this.router.navigate(["/error/404"]),!1}if(a){const r=this.permissionService.hasRole(a);if(console.log(`Verificando rol ${a}: ${r}`),!r)return console.log("Rol no autorizado, redirigiendo a error 404"),this.router.navigate(["/error/404"]),!1}return!0}static \u0275fac=function(n){return new(n||o)(t.KVO(ue.n),t.KVO(_.Ix))};static \u0275prov=t.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();const me=[{path:"",component:w,children:[{path:"register",component:V,canActivate:[C],data:{permission:"manage-own-announcements"}},{path:"list",component:at,canActivate:[C],data:{permission:"manage-own-announcements"}},{path:"list/edit/:id",component:_t,canActivate:[C],data:{permission:"manage-own-announcements"}},{path:"list/variations-specifications/:id",component:pe,canActivate:[C],data:{permission:"manage-own-announcements"}}]}];let ge=(()=>{class o{static \u0275fac=function(n){return new(n||o)};static \u0275mod=t.$C({type:o});static \u0275inj=t.G2t({imports:[_.iI.forChild(me),_.iI]})}return o})();var _e=l(4035),fe=l(102),he=l(8646);let be=(()=>{class o{static \u0275fac=function(n){return new(n||o)};static \u0275mod=t.$C({type:o});static \u0275inj=t.G2t({imports:[d.MD,ge,u.q1,c.YN,p.UN,c.X1,_e.e1,p.XZ,p.c9,fe.w,h.O.forRoot(),he.G]})}return o})()}}]);