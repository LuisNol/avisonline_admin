"use strict";(self.webpackChunkdemo1=self.webpackChunkdemo1||[]).push([[694],{8694:(G,u,r)=>{r.r(u),r.d(u,{PermissionModule:()=>T});var d=r(177),l=r(9417),g=r(2791),c=r(928),f=r(4058),v=r(8646),h=r(427),e=r(7705),b=r(7586),_=r.n(b),C=r(7030),x=r(572),k=r(1774);const y=["noticeSwal"];function j(s,m){1&s&&(e.j41(0,"div"),e.EFF(1,"Permission name is required"),e.k0s())}function P(s,m){1&s&&(e.j41(0,"div"),e.EFF(1,"Permission name must be at least 4 characters long"),e.k0s())}function S(s,m){if(1&s&&(e.j41(0,"div",37),e.DNE(1,j,2,0,"div",38),e.DNE(2,P,2,0,"div",38),e.k0s()),2&s){e.XpG();const t=e.sdS(18);e.R7$(1),e.Y8G("ngIf",null==t.errors?null:t.errors.required),e.R7$(1),e.Y8G("ngIf",null==t.errors?null:t.errors.minlength)}}const E=function(s){return{"ki-up":s}};function M(s,m){if(1&s){const t=e.RV6();e.j41(0,"form",14,15),e.bIt("ngSubmit",function(i){e.eBV(t);const o=e.sdS(1),a=e.XpG();return e.Njj(a.onSubmit(i,o))}),e.j41(2,"div",16)(3,"h4",17),e.EFF(4,"Permission Details"),e.k0s(),e.j41(5,"button",18),e.bIt("click",function(){const o=e.eBV(t).$implicit;return e.Njj(o.dismiss("Cross click"))}),e.k0s()(),e.j41(6,"div",19)(7,"div",20)(8,"div",21),e.bIt("click",function(){e.eBV(t);const i=e.sdS(13);return e.Njj(i.toggle())}),e.EFF(9,"User Information "),e.j41(10,"span",22),e.nrm(11,"i",23),e.k0s()(),e.j41(12,"div",24,25),e.bIt("ngbCollapseChange",function(i){e.eBV(t);const o=e.XpG();return e.Njj(o.isCollapsed1=i)}),e.j41(14,"div",26)(15,"label",27),e.EFF(16,"Name"),e.k0s(),e.j41(17,"input",28,29),e.bIt("ngModelChange",function(i){e.eBV(t);const o=e.XpG();return e.Njj(o.permissionModel.name=i)}),e.k0s(),e.DNE(19,S,3,2,"div",30),e.k0s()()()(),e.j41(20,"div",31)(21,"button",32),e.bIt("click",function(){const o=e.eBV(t).$implicit;return e.Njj(o.dismiss("cancel"))}),e.EFF(22," Discard "),e.k0s(),e.j41(23,"button",33)(24,"span",34),e.EFF(25," Submit "),e.k0s(),e.j41(26,"span",35),e.EFF(27," Please wait... "),e.nrm(28,"span",36),e.k0s()()()()}if(2&s){const t=e.sdS(1),n=e.XpG();e.R7$(8),e.BMQ("aria-expanded",!n.isCollapsed1),e.R7$(3),e.Y8G("ngClass",e.eq3(6,E,!n.isCollapsed1)),e.R7$(1),e.Y8G("ngbCollapse",n.isCollapsed1),e.R7$(5),e.Y8G("ngModel",n.permissionModel.name),e.R7$(2),e.Y8G("ngIf",t.submitted&&t.invalid),e.R7$(4),e.BMQ("data-kt-indicator",n.isLoading?"on":"off")}}let F=(()=>{class s{apiService;cdr;isCollapsed1=!1;isLoading=!1;permissions;datatableConfig={};reloadEvent=new e.bkB;permission$;permissionModel={id:0,name:""};noticeSwal;swalOptions={};constructor(t,n){this.apiService=t,this.cdr=n}ngAfterViewInit(){}ngOnInit(){this.datatableConfig={serverSide:!0,ajax:(t,n)=>{this.apiService.getPermissions(t).subscribe(i=>{console.log(i),n(i)})},columns:[{title:"Name",data:"name",render:(t,n,i)=>`<a href="javascript:;" data-action="view" data-id="${i.id}" class="text-gray-800 text-hover-primary mb-1">${t}</a>`},{title:"Assigned To",data:null,render:function(t,n,i){return Array.isArray(t.roles)?t.roles.map(function(o){return`<a href="#" class="badge fs-7 m-1 badge-light-${["info","success","warning","danger","primary"][Math.floor(5*Math.random())]}">${o.name}</a>`}).join(""):""},orderData:[1],orderSequence:["asc","desc"],type:"string"},{title:"Created Date",data:"created_at",render:function(t){return _()(t).format("DD MMM YYYY, hh:mm a")}}]}}delete(t){this.apiService.deletePermission(t).subscribe(()=>{this.reloadEvent.emit(!0)})}edit(t){this.permission$=this.apiService.getPermission(t),this.permission$.subscribe(n=>{this.permissionModel=n})}create(){this.permissionModel={id:0,name:""}}onSubmit(t,n){if(n&&n.invalid)return;this.isLoading=!0;const i={icon:"success",title:"Success!",text:this.permissionModel.id>0?"Permission updated successfully!":"Permission created successfully!"},o={icon:"error",title:"Error!",text:""},a=()=>{this.isLoading=!1};this.permissionModel.id>0?(()=>{this.apiService.updatePermission(this.permissionModel.id,this.permissionModel).subscribe({next:()=>{this.showAlert(i),this.reloadEvent.emit(!0)},error:p=>{o.text=this.extractText(p.error),this.showAlert(o),this.isLoading=!1},complete:a})})():(()=>{this.apiService.createPermission(this.permissionModel).subscribe({next:()=>{this.showAlert(i),this.reloadEvent.emit(!0)},error:p=>{o.text=this.extractText(p.error),this.showAlert(o),this.isLoading=!1},complete:a})})()}extractText(t){var n=[];for(var i in t)"string"==typeof t[i]?n.push(t[i]):"object"==typeof t[i]&&(n=n.concat(this.extractText(t[i])));return Array.from(new Set(n)).join("\n")}showAlert(t){let n=t.icon?.toString()||"success";"error"===t.icon&&(n="danger"),this.swalOptions=Object.assign({buttonsStyling:!1,confirmButtonText:"Ok, got it!",customClass:{confirmButton:"btn btn-"+n}},t),this.cdr.detectChanges(),this.noticeSwal.fire()}ngOnDestroy(){}static \u0275fac=function(n){return new(n||s)(e.rXU(C.n),e.rXU(e.gRc))};static \u0275cmp=e.VBU({type:s,selectors:[["app-permission-listing"]],viewQuery:function(n,i){if(1&n&&e.GBs(y,5),2&n){let o;e.mGM(o=e.lsd())&&(i.noticeSwal=o.first)}},decls:16,vars:4,consts:[[1,"card"],[1,"card-header","border-0","pt-6"],[1,"card-title"],[1,"d-flex","align-items-center","position-relative","my-1"],["name","magnifier",1,"fs-3","position-absolute","ms-5"],["type","text","data-action","filter","placeholder","Search Users",1,"form-control","form-control-solid","w-250px","ps-12"],[1,"card-toolbar"],[1,"d-flex","justify-content-end"],["type","button","data-action","create",1,"btn","btn-primary"],[1,"card-body","pt-0"],["route","/apps/users",3,"datatableConfig","reload","modal","deleteEvent","editEvent","createEvent"],[3,"swalOptions"],["noticeSwal",""],["formModal",""],[3,"ngSubmit"],["myForm","ngForm"],[1,"modal-header"],["id","modal-basic-title",1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],["id","kt_modal_update_customer_scroll","data-kt-scroll","true","data-kt-scroll-activate","{default: false, lg: true}","data-kt-scroll-max-height","auto","data-kt-scroll-dependencies","#kt_modal_update_customer_header","data-kt-scroll-wrappers","#kt_modal_update_customer_scroll","data-kt-scroll-offset","300px",1,"d-flex","flex-column","scroll-y","me-n7","pe-7","mw-650px"],["data-bs-toggle","collapse","role","button","aria-controls","kt_modal_update_customer_user_info",1,"fw-bold","fs-3","rotate","collapsible","mb-7",3,"click"],[1,"ms-2","rotate-180"],[1,"ki-duotone","ki-down","fs-3",3,"ngClass"],[1,"collapse","show",3,"ngbCollapse","ngbCollapseChange"],["collapse1","ngbCollapse"],[1,"fv-row","mb-7"],[1,"required","fw-semibold","fs-6","mb-2"],["type","text","name","name","required","","minlength","4",1,"form-control","form-control-solid",3,"ngModel","ngModelChange"],["name","ngModel"],["class","fv-plugins-message-container fv-plugins-message-container--enabled invalid-feedback",4,"ngIf"],[1,"modal-footer","flex-center"],["type","reset","id","kt_modal_update_customer_cancel",1,"btn","btn-light","me-3",3,"click"],["type","submit","id","kt_modal_update_customer_submit",1,"btn","btn-primary"],[1,"indicator-label"],[1,"indicator-progress"],[1,"spinner-border","spinner-border-sm","align-middle","ms-2"],[1,"fv-plugins-message-container","fv-plugins-message-container--enabled","invalid-feedback"],[4,"ngIf"]],template:function(n,i){if(1&n&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),e.nrm(4,"app-keenicon",4)(5,"input",5),e.k0s()(),e.j41(6,"div",6)(7,"div",7)(8,"button",8),e.EFF(9," Add Permissions "),e.k0s()()()(),e.j41(10,"div",9)(11,"app-crud",10),e.bIt("deleteEvent",function(a){return i.delete(a)})("editEvent",function(a){return i.edit(a)})("createEvent",function(){return i.create()}),e.k0s()()(),e.nrm(12,"swal",11,12),e.DNE(14,M,29,8,"ng-template",null,13,e.C5r)),2&n){const o=e.sdS(15);e.R7$(11),e.Y8G("datatableConfig",i.datatableConfig)("reload",i.reloadEvent)("modal",o),e.R7$(1),e.Y8G("swalOptions",i.swalOptions)}},dependencies:[d.YU,d.bT,l.qT,l.me,l.BC,l.cb,l.YS,l.xh,l.vS,l.cV,x.i,k.w,c.$G,f.b7]})}return s})(),w=(()=>{class s{static \u0275fac=function(n){return new(n||s)};static \u0275cmp=e.VBU({type:s,selectors:[["app-permission-details"]],decls:2,vars:0,template:function(n,i){1&n&&(e.j41(0,"p"),e.EFF(1,"permission-details works!"),e.k0s())}})}return s})(),T=(()=>{class s{static \u0275fac=function(n){return new(n||s)};static \u0275mod=e.$C({type:s});static \u0275inj=e.G2t({imports:[d.MD,l.YN,l.X1,g.iI.forChild([{path:"",component:F},{path:":id",component:w}]),h.B,v.G,c.Pv,c.zH,c.HC,c.n8,f.RZ.forChild()]})}return s})()}}]);